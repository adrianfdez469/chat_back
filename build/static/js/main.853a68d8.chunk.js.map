{"version":3,"sources":["components/socket.js","components/recoil/atoms.js","conf/configuration.js","components/login/login.js","components/contacts/avatar.js","components/contacts/contact.js","components/contacts/contacts.js","components/chat/message.js","components/chat/friendHeader/friendHeader.js","components/chat/chat.js","components/header/header.js","components/events/newUserSubscriber.js","components/events/userDisconnectSubscriber.js","components/events/incomingMsgSubscriber.js","App.js","serviceWorker.js","index.js"],"names":["socket","idiomaState","atom","key","default","loginData","chatConversation","contactListState","view","posibleViews","LOGIN","CONTACTS","CHAT","getAtom","subscribeToEventsState","DEFAULT_CONFIG","server","socketClient","getSocket","openSocket","Login","props","idioma","useRecoilValue","setLoginData","useSetRecoilState","setView","useRecoilState","setSubscribeToEvents","useState","nickname","valid","nick","setNick","setLogin","axios","post","then","resp","status","client","emit","_id","data","Error","socketId","id","catch","err","console","log","className","text","welcome","type","placeholder","onChange","value","target","test","onKeyPress","event","charCode","onClick","txtBtn","VisualAvatar","size","novistos","styleOut","width","height","styleHead","styleBody","pos","toString","length","badgeStyle","top","right","style","Contact","conversation","setConversation","cantidad","lastMessage","msg","newConversation","active","activeOnline","Contacts","userData","contactList","setContactList","useEffect","get","map","user","filter","overflowY","contact","Message","myMsg","msgStyle","FriendHeader","backClick","online","Chat","loginDataUser","setConvertation","refAreaTexto","useRef","sendMsg","current","innerText","replace","newStateObj","from","toUserId","toSocketId","focus","element","document","getElementById","scrollTop","scrollHeight","elem","idx","arr","marginBottom","borderRadius","role","contentEditable","ref","disabled","btnSend","Header","setIdioma","UserSubscriber","setContactListState","on","off","IncomingMsgSubscriber","App","viewState","subscribe","cmp","subscriptions","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","navigator","serviceWorker","ready","registration","unregister","error","message"],"mappings":"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","file":"static/js/main.853a68d8.chunk.js","sourcesContent":["import openSocket from 'socket.io-client'; \r\nimport {DEFAULT_CONFIG} from '../conf/configuration';\r\nlet socket;\r\n\r\nconst socketClient = \r\n {   \r\n    getSocket: () => {\r\n        if(!socket){\r\n            socket = openSocket(DEFAULT_CONFIG.server);\r\n            //socket = openSocket(\"https://shut-upp-back.herokuapp.com\");\r\n            return socket;    \r\n        }\r\n        return socket;\r\n    }\r\n};\r\n\r\nexport default socketClient;","import {atom} from 'recoil';\r\n\r\nconst idiomaState = atom({\r\n    key: 'idiomaState',\r\n    default: 'es'\r\n});\r\n\r\nconst loginData = atom({\r\n    key: 'loginData',\r\n    default: null\r\n})\r\n\r\nconst chatConversation = atom({\r\n    key: 'chatConversation',\r\n    default: {\r\n        'active': false\r\n    }\r\n});\r\n\r\nconst contactListState = atom({\r\n    key: 'contactListState',\r\n    default: []\r\n});\r\n\r\n\r\nconst view = {\r\n    posibleViews: {\r\n        LOGIN: 'LOGIN',\r\n        CONTACTS: 'CONTACTS',\r\n        CHAT: 'CHAT'\r\n    },\r\n    getAtom: atom({\r\n        key: 'view',\r\n        default: 'LOGIN'\r\n    })\r\n};\r\n\r\nconst subscribeToEventsState = atom({\r\n    key: 'subscribeToEventsState',\r\n    default: false\r\n})\r\n\r\nexport {idiomaState, loginData, chatConversation, view, contactListState, subscribeToEventsState};","const DEV = {\r\n    server: \"http://localhost:3001\"\r\n}\r\nconst PROD = {\r\n    server: \"https://shut-app-back.herokuapp.com\"\r\n}\r\n\r\nexport const DEFAULT_CONFIG = process.env.NODE_ENV === \"development\" ? DEV : PROD;","import React, {useState} from 'react';\r\nimport { useRecoilValue, useRecoilState, useSetRecoilState } from 'recoil';\r\nimport axios from 'axios';\r\nimport {idiomaState, loginData, view, contactListState, subscribeToEventsState} from '../recoil/atoms';\r\n//import classes from './login.module.css';\r\nimport text from './idioma.json';\r\nimport socket from '../socket';\r\nimport {DEFAULT_CONFIG} from '../../conf/configuration';\r\n\r\nconst Login = props => {\r\n    const idioma = useRecoilValue(idiomaState);\r\n    const setLoginData = useSetRecoilState(loginData);\r\n    const setView = useSetRecoilState(view.getAtom);\r\n    const [contactList, setContactListState] = useRecoilState(contactListState);\r\n    const setSubscribeToEvents = useSetRecoilState(subscribeToEventsState);\r\n    const [nick, setNick] = useState({\r\n        nickname: '', valid: null\r\n    });\r\n\r\n    const setNickName = ({target: {value}}) => {\r\n        if(/^[a-zA-Z][a-zA-Z0-9]{2,10}$/.test(value)){\r\n            setNick({nickname: value, valid: true});\r\n        }else{\r\n            setNick({nickname: value, valid: false});\r\n        }\r\n    };\r\n\r\n    const setLogin = (nickname) => {\r\n        axios\r\n            .post(`${DEFAULT_CONFIG.server}/login`, {nickname: nickname})\r\n            //.post('https://shut-upp-back.herokuapp.com/', {nickname: nickname})\r\n            .then((resp) => {\r\n                if(resp.status === 200){\r\n                    const client = socket.getSocket();\r\n                    client.emit('new user', {nickname: nickname, _id: resp.data._id});\r\n                    return {\r\n                        client: client, \r\n                        nickname: nickname, \r\n                        _id:resp.data._id\r\n                    };\r\n                }else{\r\n                    throw Error ('El login no fue satiscactorio');\r\n                }\r\n            })\r\n            .then(resp => {\r\n                setLoginData({nickname: resp.nickname, _id: resp._id, socketId: resp.client.id});\r\n            })\r\n            .then(() => {setSubscribeToEvents(true)})\r\n            .then(() => {setView(view.posibleViews.CONTACTS)})\r\n            .catch(err => {console.log(err)})\r\n    }\r\n\r\n    const keyPress = (event) => {\r\n        if(event.charCode === 13){\r\n            setLogin(nick.nickname);\r\n        }\r\n    }\r\n    \r\n\r\n    return (\r\n        <div className='login'>\r\n            <h2>{text.welcome[idioma]}</h2>\r\n            <input type=\"text\" placeholder={text.placeholder[idioma]} \r\n                onChange={setNickName}\r\n                onKeyPress={keyPress} \r\n                value={nick.nickname} \r\n                className={nick.valid ? 'valid' : 'invalid'}                \r\n            />\r\n            {nick.valid ? <button onClick={() => setLogin(nick.nickname)}>{text.txtBtn[idioma]}</button> : null}\r\n        </div>\r\n    );\r\n\r\n}\r\nexport default Login;","import React from 'react';\r\n\r\n\r\n\r\nconst VisualAvatar = ({size = 1, novistos = 0}) => {\r\n\r\n    const styleOut = {\r\n        width: `${50*size}px`,\r\n        height: `${50*size}px`\r\n    }\r\n\r\n    const styleHead = {\r\n        width: `${20*size}px`,\r\n        height: `${20*size}px`\r\n    };\r\n\r\n    const styleBody = {\r\n        width: `${35*size}px`,\r\n        height: `${30*size}px`\r\n    }\r\n    const pos = novistos.toString().length <= 3 ? novistos.toString().length * 3 : 10; \r\n    const badgeStyle = {\r\n        top: `-${pos}px`,\r\n        right: `-${pos}px`\r\n    }\r\n\r\n    return (\r\n        <div className=\"avatar\">\r\n            <div className='avatarOut' style={styleOut}>\r\n                <div className='avatarHead' style={styleHead}></div>\r\n                <div className='avatarTrunk' style={styleBody}></div>\r\n            </div>\r\n            {novistos > 0 \r\n                ? <span className=\"badge\" style={badgeStyle}>{novistos}</span>\r\n                : null\r\n            }\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default VisualAvatar;","import React from 'react';\r\nimport {useRecoilState, useSetRecoilState} from 'recoil';\r\nimport {chatConversation, view} from '../recoil/atoms';\r\nimport VisualAvatar from './avatar';\r\n\r\nconst Contact = ({nickname, _id, socketId}) => {\r\n    const [conversation, setConversation] = useRecoilState(chatConversation);\r\n    const setView = useSetRecoilState(view.getAtom);\r\n    \r\n    const cantidad = conversation[_id]?.novistos ? conversation[_id].novistos : 0;\r\n    let lastMessage = '';\r\n    if(conversation[_id] && conversation[_id].text){        \r\n        lastMessage = conversation[_id].text[conversation[_id].text.length-1]?.msg ? conversation[_id].text[conversation[_id].text.length-1].msg : '';\r\n    }\r\n    \r\n\r\n    const startConvertation = () => {\r\n        \r\n        const newConversation = {...conversation, active: _id, activeOnline: true};\r\n        if(!newConversation[_id]) {\r\n            newConversation[_id] = {\r\n                nickname: nickname,\r\n                text: [],\r\n                socketId: socketId,\r\n                novistos: 0\r\n            };            \r\n        }else{\r\n            newConversation[_id] = {\r\n                nickname: nickname,\r\n                socketId: socketId,\r\n                text: [...conversation[_id].text],\r\n                novistos: 0\r\n            }\r\n        }\r\n        setConversation(newConversation);\r\n        setView(view.posibleViews.CHAT);\r\n    };  \r\n\r\n    return (\r\n        <div className='contact contact-item' onClick={startConvertation}>\r\n            <VisualAvatar novistos={cantidad}/>\r\n            <div className='contactBody'>\r\n                <div className='status'>\r\n                    <span className=\"nickname\">{nickname}</span>\r\n                    <span className=\"connectionStatus\"></span>\r\n                </div>\r\n                <div className=\"lastMsg\">{lastMessage}</div>\r\n            </div>\r\n\r\n            {/*<button className={classes.options}>...</button>*/}\r\n        </div>\r\n    );\r\n\r\n}\r\nexport default Contact;","import React, {useEffect} from 'react';\r\nimport axios from 'axios';\r\nimport Contact from './contact';\r\nimport {loginData, contactListState} from '../recoil/atoms';\r\nimport {useRecoilValue, useRecoilState} from 'recoil';\r\nimport {DEFAULT_CONFIG} from '../../conf/configuration';\r\n\r\nconst Contacts = props => {\r\n    const userData = useRecoilValue(loginData);\r\n    const [contactList, setContactList] = useRecoilState(contactListState);\r\n\r\n    useEffect(() => {\r\n        axios.get(`${DEFAULT_CONFIG.server}/users`)\r\n        //axios.get('https://shut-upp-back.herokuapp.com/')\r\n            .then(resp => {\r\n                if(resp.status === 200){\r\n                    setContactList(\r\n                        resp.data.data\r\n                            .map(user => ({nick: user.nickname, _id: user._id, socketId: user.socketId}))\r\n                            .filter(user => user._id !== userData._id)\r\n                    );\r\n                }\r\n            })\r\n            .catch(err => console.log(err));\r\n    }, []);\r\n\r\n    const style = {\r\n        overflowY: \"scroll\",\r\n        height: 'calc(100% - 70px)'\r\n    };\r\n\r\n    return (\r\n        <div style={style}> \r\n            {contactList.map(contact => {\r\n                return <div key={contact._id}><Contact nickname={contact.nick} _id={contact._id} socketId={contact.socketId}/></div>\r\n            })}\r\n        </div>\r\n    );\r\n\r\n}\r\nexport default Contacts;","import React from 'react';\r\n//import './chateditor.css';\r\n\r\nconst Message = ({myMsg = true, msg, style}) => {\r\n\r\n    const msgStyle = myMsg ? 'mymsg' : 'notmymsg';\r\n\r\n    return (\r\n        <div className={`message ${msgStyle}`} style={style}>\r\n            {msg}\r\n        </div>\r\n    );\r\n\r\n}\r\nexport default Message;","import React from 'react';\r\nimport VisualAvatar from '../../contacts/avatar';\r\n\r\nconst FriendHeader = ({nickname, backClick, online = true}) => {\r\n\r\n    return (\r\n        <div className='contact contact-chat'>\r\n            <div className=\"goBack\" onClick={backClick}></div>\r\n            <VisualAvatar size={0.8}/>\r\n\r\n            <div className='contactBody'>\r\n                <div className='status'>\r\n                    <span className=\"nickname\">{nickname}</span>\r\n                    <span className={`connectionStatus ${online ? 'online':'offline' }`}>{online ? 'Online' : 'Offline'}</span>\r\n                </div>\r\n            </div>\r\n            {/*<button className={classes.options}>...</button>*/}\r\n        </div>\r\n    );\r\n\r\n}\r\nexport default FriendHeader;","import React, {useRef, useEffect} from 'react';\r\nimport {useRecoilValue, useRecoilState, useSetRecoilState} from 'recoil';\r\nimport {idiomaState, chatConversation, loginData, view} from '../recoil/atoms';\r\nimport text from './idioma.json';\r\nimport Message from './message';\r\nimport socket from '../socket';\r\nimport FriendHeader from './friendHeader/friendHeader';\r\n\r\nconst Chat = props => {\r\n\r\n    const idioma = useRecoilValue(idiomaState);\r\n    const loginDataUser = useRecoilValue(loginData);\r\n    const [conversation, setConvertation] = useRecoilState(chatConversation);\r\n    const refAreaTexto = useRef('');\r\n    const setView = useSetRecoilState(view.getAtom);\r\n\r\n    const client = socket.getSocket();\r\n    \r\n    const sendMsg = () => {\r\n        \r\n        const oldtext = refAreaTexto.current.innerText;\r\n        const text = oldtext.replace(/^(\\s*\\r*)(.)(\\s*\\r*)$/, '$2');\r\n        if(text !== ''){\r\n            const newStateObj = {...conversation};\r\n            newStateObj[newStateObj.active] = {...newStateObj[conversation.active]};\r\n            newStateObj[newStateObj.active].text = [...newStateObj[newStateObj.active].text, {myMsg: true, msg: text}];\r\n            setConvertation(newStateObj);\r\n            client.emit('message', {from: loginDataUser._id, toUserId: conversation.active, toSocketId: conversation[conversation.active].socketId, msg: text});\r\n            refAreaTexto.current.innerText = '';\r\n            refAreaTexto.current.focus();\r\n        }\r\n        \r\n    };\r\n\r\n    useEffect(() => {\r\n        var element = document.getElementById('chatConversation');\r\n        if(element)\r\n            element.scrollTop = element.scrollHeight;\r\n    });\r\n\r\n    \r\n\r\n    const goBack = () => {\r\n        setView(view.posibleViews.CONTACTS);\r\n        setConvertation({...conversation, active: null});\r\n    }\r\n\r\n    const keyPress = (event) => {\r\n        if(conversation.activeOnline){\r\n            if(event.charCode === 13){\r\n                sendMsg();\r\n                \r\n            }\r\n        }\r\n        \r\n    }\r\n\r\n    return (\r\n        <div id=\"chatContainer\">\r\n            <FriendHeader backClick={goBack} nickname={conversation[conversation.active].nickname} online={conversation.activeOnline}/>\r\n            \r\n            <div id=\"chatConversation\">\r\n                {conversation[conversation.active].text.map((elem, idx, arr) => {\r\n                    const style = {};\r\n\r\n                    if(arr[idx + 1] && elem.myMsg === arr[idx+1].myMsg){\r\n                        style.marginBottom = '-3px';\r\n                        style.borderRadius = elem.myMsg ? \"10px 0px 10px 10px\" : \"0 10px 10px 10px\";\r\n                    }\r\n                    if(idx > 0 && elem.myMsg === arr[idx-1].myMsg){\r\n                        style.borderRadius = elem.myMsg ? \"10px 10px 10px 10px\" : \"10px 10px 10px 10px\";\r\n                    }\r\n                    \r\n                    return <Message {...elem} key={idx} style={style}/>\r\n                })}\r\n            </div>\r\n\r\n            <div id=\"editor\"> \r\n                <div id=\"textarea\" role=\"textbox\" contentEditable={conversation.activeOnline} ref={refAreaTexto} onKeyPress={keyPress}></div>\r\n                <button id=\"sendButton\" disabled={!conversation.activeOnline} onClick={sendMsg}>{text.btnSend[idioma]}</button>\r\n            </div>\r\n\r\n        </div>\r\n    );\r\n\r\n}\r\nexport default Chat;","import React from 'react';\r\nimport {useRecoilState} from 'recoil';\r\nimport {idiomaState} from '../recoil/atoms';\r\n//import classes from './header.module.css';\r\n\r\nconst Header = props => {\r\n    const [idioma, setIdioma] = useRecoilState(idiomaState);\r\n\r\n    const changeIdioma = ({target: {value}}) => {\r\n        setIdioma(value);\r\n    }\r\n\r\n    return (\r\n        <div className='headerdiv'>\r\n            <div className='infoapp'>\r\n                <div className='apptitle'>Chatapp</div>\r\n            </div>\r\n            \r\n            <select value={idioma} onChange={changeIdioma} className='idiomaselect'>\r\n                <option value=\"es\">ES</option>\r\n                <option value=\"en\">EN</option>\r\n            </select>\r\n        </div>\r\n    );\r\n\r\n}\r\nexport default Header;","import React, {useEffect} from 'react';\r\nimport {useRecoilState} from 'recoil';\r\nimport {contactListState} from '../recoil/atoms';\r\nimport socket from '../socket'\r\n\r\nconst UserSubscriber = props => {\r\n    const [contactList, setContactListState] = useRecoilState(contactListState);\r\n    const client = socket.getSocket();\r\n\r\n    useEffect(() => {\r\n\r\n        client.on('new user', data => {\r\n            setContactListState([...contactList, {nick: data.nickname, _id: data._id, socketId: data.socketId}]);\r\n        });\r\n\r\n        return () => client.off('new user');\r\n    }, [contactList]);\r\n\r\n    return (\r\n        <></>\r\n    );\r\n\r\n}\r\nexport default UserSubscriber;","import React, {useEffect} from 'react';\r\nimport {useRecoilState} from 'recoil';\r\nimport {contactListState, chatConversation} from '../recoil/atoms';\r\nimport socket from '../socket'\r\n\r\nconst UserSubscriber = props => {\r\n    const [contactList, setContactListState] = useRecoilState(contactListState);\r\n    const [conversation, setConversation] = useRecoilState(chatConversation);\r\n    const client = socket.getSocket();\r\n\r\n    useEffect(() => {\r\n        \r\n        client.on('user disconnect', data => {\r\n            setContactListState(contactList.filter(contact => contact._id !== data._id));\r\n            if(conversation.active === data._id){\r\n                setConversation({...conversation, activeOnline: false});\r\n            }\r\n        });\r\n\r\n        return () => client.off('user disconnect');\r\n    }, [conversation]);\r\n\r\n    return (\r\n        <></>\r\n    );\r\n\r\n}\r\nexport default UserSubscriber;","import React, {useEffect} from 'react';\r\nimport {useRecoilState} from 'recoil';\r\nimport {chatConversation} from '../recoil/atoms';\r\nimport socket from '../socket'\r\nconst IncomingMsgSubscriber = props => {\r\n\r\n    const [conversation, setConvertation] = useRecoilState(chatConversation);\r\n    const client = socket.getSocket();\r\n    \r\n    useEffect(() => {\r\n\r\n        client.on('message', data => {\r\n            const newStateObj = {...conversation};\r\n            if(conversation[data._id]){\r\n                newStateObj[data._id] = {...conversation[data._id]};\r\n                if(conversation[data._id].text){\r\n                    newStateObj[data._id].text = [...conversation[data._id].text, {myMsg: false, msg: data.msg}];\r\n                    \r\n                    \r\n\r\n                    if(data._id !== newStateObj.active){\r\n                        newStateObj[data._id].novistos = newStateObj[data._id].novistos + 1; \r\n                    }\r\n                }else{\r\n                    newStateObj[data._id].text = [];\r\n                }\r\n                \r\n            }else{\r\n                newStateObj[data._id] = {\r\n                    text: [{myMsg: false, msg: data.msg}],\r\n                    nickname: null,\r\n                    socketId: null,\r\n                    novistos: 1\r\n                }\r\n            }\r\n            setConvertation(newStateObj);\r\n        });\r\n\r\n        return () => client.off('message');\r\n    }, [conversation]);\r\n\r\n    return (\r\n        <></>\r\n    );\r\n\r\n}\r\nexport default IncomingMsgSubscriber;","import React from 'react';\nimport {useRecoilValue} from 'recoil';\nimport {view, subscribeToEventsState} from './components/recoil/atoms';\nimport Login from './components/login/login';\nimport Contacts from './components/contacts/contacts';\nimport Chat from './components/chat/chat';\n//import Chat from './components/chat/chat';\nimport Header from './components/header/header';\nimport NewUserSubscriber from './components/events/newUserSubscriber';\nimport UserDisconnectSubscriber from './components/events/userDisconnectSubscriber';\nimport IncomingMsgSubscriber from './components/events/incomingMsgSubscriber';\nimport './App.css';\n\n\nfunction App() {\n  const viewState = useRecoilValue(view.getAtom);\n  const subscribe = useRecoilValue(subscribeToEventsState);\n  const cmp = viewState === view.posibleViews.LOGIN ? <Login /> : viewState === view.posibleViews.CONTACTS ? <Contacts /> : <Chat />;\n\n  let subscriptions = null;\n  if(subscribe){\n    subscriptions = <>\n      <NewUserSubscriber />\n      <UserDisconnectSubscriber />\n      {<IncomingMsgSubscriber />}\n    </>\n  }\n\n  return (\n      <div className=\"main\">\n        <Header />        \n        {cmp}\n        {subscriptions}\n      </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport {RecoilRoot} from 'recoil';\n\nReactDOM.render(\n  <React.StrictMode>\n    <RecoilRoot>\n      <App />\n    </RecoilRoot>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}