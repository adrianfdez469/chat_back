{"version":3,"sources":["utils/socket.js","authMiddleware.js","utils/useLogout.js","components/recoil/atoms.js","view/signin/forgotpass/forgotPass.view.js","view/signin/forgotpass/forgotPass.controller.js","view/signin/forgotpass/index.js","view/signin/signin.view.js","view/signin/signin.controller.js","view/signin/index.js","view/main/main.view.js","view/main/index.js","view/signup/signup.view.js","view/signup/signup.controller.js","view/signup/index.js","components/uiComponents/notification/notification.view.js","components/uiComponents/index.js","utils/useRefreshToken.js","App.js","serviceWorker.js","index.js","conf/configuration.js","components/uiComponents/notification/notification.hook.js","components/uiComponents/notification/notification.atom.js"],"names":["socket","socketClient","getSocket","openSocket","DEFAULT_CONFIG","server","close","AuthMiddleware","nextOptimisticAction","a","token","localStorage","getItem","token_expires","Date","getTime","dataOptimistic","useLogout","setLoginData","useSetRecoilState","loginData","setUserAvatar","userAvatarState","setSubscribe","subscribeToEventsState","setContactList","contactListState","setFriends","friendsAtom","client","useCallback","emit","removeItem","idiomaState","atom","key","default","idioma","userLang","navigator","language","userLanguage","test","getDefaultLanguage","chatConversation","addContactViewOpenState","activeChatWith","getConversationWithContact","contactId","tokenTimeoutAtom","tokentimeout","darkModeAtom","ForgotPassView","forgetPassHandler","forgotWinState","forgotWinOk","onChangeForgotEmail","forgotEmailState","Dialog","open","onClose","aria-labelledby","DialogTitle","id","text","title","DialogContent","DialogContentText","forgotText","TextField","autoFocus","margin","label","email","type","fullWidth","onChange","value","helperText","valid","invalidEmail","error","DialogActions","Button","onClick","color","forgotBtnCancel","forgotBtnOk","ForgotPassController","useState","setForgotEmailStste","NotificationHook","openSuccessNotification","openErrorNotification","target","axios","post","hostname","window","location","host","then","resp","status","emailSended","catch","err","response","emailNotFound","connError","ForgotPass","props","useStyles","makeStyles","theme","paper","marginTop","spacing","display","flexDirection","alignItems","avatar","backgroundColor","palette","secondary","main","form","width","submit","link","cursor","textDecoration","SignIn","emailRef","passRef","onSignIn","rememberChecked","onRememberChange","classes","Container","component","maxWidth","CssBaseline","className","Avatar","Typography","variant","signin","noValidate","required","name","autoComplete","inputRef","password","FormControlLabel","control","Checkbox","checked","rememberme","Grid","container","item","xs","Link","forgotpassword","to","gosignup","SigninController","useRecoilState","setIdiomaState","setUserAvatarState","setTokenTimeOut","redirectState","setRedirect","useRef","remember","setRemember","setforgotWinState","useEffect","authMiddleware","data","_id","nickname","firstName","lastName","gender","avatarUrl","setItem","timeleft","userId","notAuthorized","internalError","connErr","current","event","preventDefault","refresh_token","refresh_token_expires","message","notActive","Signin","padding","position","height","overflowY","background","MainView","children","MainContainer","SignUp","onSignUp","emailState","onEmailChange","passState","onPassChange","nameState","onNameChange","lastNameRef","signup","sm","msg","justify","SignupController","useRecoilValue","setEmailState","setPassState","setNameState","length","userCreated","duplicated","Signup","Alert","elevation","NotificationView","notificationAtom","notificationState","setNotState","handleClose","reason","Snackbar","autoHideDuration","anchorOrigin","vertical","horizontal","severity","Notification","useRefreshToken","setTokenTimeout","logout","new_token","new_refresh_token","new_token_expires","new_refresh_token_expires","AsyncToolbar","React","lazy","AsyncMainButton","AsyncContactList","AsyncChatCmp","AsyncActivateUser","AsyncChangePass","AsyncEvents","TimerCmp","refreshToken","timeoutData","setTimeout","themeDark","createMuiTheme","themeDefault","backdrop","zIndex","drawer","App","dark","subscribe","userData","chatWith","notistackRef","createRef","onClickDismiss","closeSnackbar","cmp","path","exact","render","ThemeProvider","fallback","Backdrop","CircularProgress","maxSnack","preventDuplicate","ref","action","IconButton","fontSize","style","from","isLocalhost","Boolean","match","registerValidSW","swUrl","config","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","onUpdate","onSuccess","ReactDOM","StrictMode","document","getElementById","URL","process","href","origin","addEventListener","fetch","headers","contentType","get","indexOf","ready","unregister","reload","checkValidServiceWorker","setNotificationState","defaultToOpem","openSpecificNotification","openNotification","properties","openInfoNotification","openWarningNotification"],"mappings":"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","file":"static/js/main.e7eeccef.chunk.js","sourcesContent":["import openSocket from 'socket.io-client'; \r\nimport {DEFAULT_CONFIG} from '../conf/configuration';\r\nlet socket;\r\n\r\nconst socketClient = \r\n {   \r\n    getSocket: () => {\r\n        if(!socket){\r\n            socket = openSocket(DEFAULT_CONFIG.server);\r\n            return socket;    \r\n        }\r\n        return socket;\r\n    },\r\n    close: () => {\r\n        socket.close();\r\n    }\r\n};\r\n\r\nexport default socketClient;","const AuthMiddleware = async (nextOptimisticAction) => {\r\n    // Revisar si el token esta en timepo\r\n    const token = localStorage.getItem('token');\r\n    const token_expires = localStorage.getItem('token_expires');\r\n\r\n    if (token && token_expires && new Date(token_expires).getTime() > new Date().getTime()) {\r\n      const dataOptimistic = await nextOptimisticAction(token);\r\n      return dataOptimistic;\r\n    } \r\n  }\r\n\r\n  \r\n  export default AuthMiddleware;","import {useSetRecoilState} from 'recoil';\r\nimport axios from 'axios';\r\nimport {loginData, userAvatarState, subscribeToEventsState, contactListState, friendsAtom} from '../components/recoil/atoms';\r\nimport { useCallback } from 'react';\r\nimport socketClient from './socket';\r\n\r\nconst useLogout = () => {\r\n\r\n    const setLoginData = useSetRecoilState(loginData);\r\n    const setUserAvatar = useSetRecoilState(userAvatarState);\r\n    const setSubscribe = useSetRecoilState(subscribeToEventsState);\r\n    const setContactList = useSetRecoilState(contactListState);\r\n    const setFriends = useSetRecoilState(friendsAtom);\r\n    const client = socketClient.getSocket();\r\n\r\n    return useCallback(() => {\r\n        \r\n        setUserAvatar(null);\r\n        setContactList([]);\r\n        setFriends([]);\r\n        client.emit('logout', {});\r\n        localStorage.removeItem('token');\r\n        localStorage.removeItem('refresh_token');\r\n        localStorage.removeItem('refresh_token_expires');\r\n        localStorage.removeItem('token_expires');\r\n        setSubscribe(false);\r\n        setLoginData(null);\r\n        \r\n        \r\n    });\r\n}\r\nexport default useLogout;","\r\nimport {atom, selector} from 'recoil';\r\n\r\nconst getDefaultLanguage= () => {\r\n    let idioma = 'en';\r\n    var userLang = navigator.language || navigator.userLanguage;\r\n    if(/^(es-).+/.test(userLang)){\r\n        idioma = 'es';\r\n    }\r\n    return idioma;\r\n}\r\n\r\nconst idiomaState = atom({\r\n    key: 'idiomaState',\r\n    default: getDefaultLanguage()\r\n});\r\n\r\nconst loginData = atom({\r\n    key: 'loginData',\r\n    default: null\r\n});\r\nconst userAvatarState = atom({\r\n    key: 'userAvatarState',\r\n    default: null\r\n});\r\n\r\n\r\n\r\nconst chatConversation = atom({\r\n    key: 'chatConversation',\r\n    default: {\r\n        'active': false\r\n    }\r\n});\r\n\r\nconst contactListState = atom({\r\n    key: 'contactListState',\r\n    default: []\r\n});\r\n\r\n\r\nconst view = {\r\n    posibleViews: {\r\n        LOGIN: 'LOGIN',\r\n        CONTACTS: 'CONTACTS',\r\n        CHAT: 'CHAT'\r\n    },\r\n    getAtom: atom({\r\n        key: 'view',\r\n        default: 'LOGIN'\r\n    })\r\n};\r\n\r\nconst backdropState = atom({\r\n    key: 'backdropState',\r\n    default: false\r\n});\r\n\r\nconst subscribeToEventsState = atom({\r\n    key: 'subscribeToEventsState',\r\n    default: false\r\n})\r\n\r\nconst addContactViewOpenState = atom({\r\n    key: 'addContactViewOpenState',\r\n    default: false\r\n});\r\n\r\nconst friendsAtom = atom({\r\n    key: 'friendsAtom',\r\n    default: []\r\n});\r\n\r\nconst activeChatWith = atom({\r\n    key: 'activeChatWith',\r\n    default: null\r\n});\r\n\r\nconst getConversationWithContact = contactId => atom({\r\n    key: `conversationWith_${contactId}`,\r\n    default: []\r\n});\r\n\r\nconst messagesAtom = atom({\r\n    key: 'messagesAtom',\r\n    default: null\r\n});\r\n\r\nconst tokenTimeoutAtom = atom({\r\n    key: 'tokenTimeoutAtom',\r\n    default: {\r\n        tokentimeout: 0\r\n    }\r\n});\r\n\r\nconst darkModeAtom = atom({\r\n    key: 'themeAtom',\r\n    default: localStorage.getItem('darkMode') === 'true' ? true : false\r\n});\r\n\r\nexport {idiomaState, loginData, chatConversation, view, contactListState, subscribeToEventsState, \r\n    backdropState, userAvatarState, addContactViewOpenState,\r\n    friendsAtom, \r\n    activeChatWith, messagesAtom, getConversationWithContact, tokenTimeoutAtom, darkModeAtom\r\n};","import React from 'react';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Button from '@material-ui/core/Button';\r\nimport {Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle} from '@material-ui/core';\r\nimport text from './idioma.json';\r\n\r\n\r\n\r\nconst ForgotPassView = ({idioma, forgetPassHandler, forgotWinState, forgotWinOk, onChangeForgotEmail, forgotEmailState}) => {\r\n\r\n    return (\r\n        <Dialog open={forgotWinState} onClose={forgetPassHandler} aria-labelledby=\"form-dialog-title\">\r\n        <DialogTitle id=\"form-dialog-title\">{text.title[idioma]}</DialogTitle>\r\n        <DialogContent>\r\n          <DialogContentText>\r\n            {text.forgotText[idioma]}\r\n          </DialogContentText>\r\n          <TextField\r\n            autoFocus\r\n            margin=\"dense\"\r\n            id=\"name\"\r\n            label={text.email[idioma]}\r\n            type=\"email\"\r\n            fullWidth\r\n            onChange={onChangeForgotEmail}\r\n            value={forgotEmailState.value}\r\n            helperText={!forgotEmailState.valid ? text.invalidEmail[idioma] : ''}\r\n            error={!forgotEmailState.valid}\r\n\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={forgetPassHandler} color=\"primary\">\r\n            {text.forgotBtnCancel[idioma]}\r\n          </Button>\r\n          <Button onClick={forgotWinOk} color=\"primary\">\r\n            {text.forgotBtnOk[idioma]}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    );\r\n\r\n}\r\nexport default ForgotPassView;","import React, {useState} from 'react';\r\nimport NotificationHook from '../../../components/uiComponents/notification/notification.hook';\r\nimport text from './idioma.json';\r\nimport ForgotPassView from './forgotPass.view';\r\nimport axios from 'axios';\r\nimport {DEFAULT_CONFIG} from '../../../conf/configuration';\r\n\r\n\r\nconst ForgotPassController = ({idioma, forgotWinState, forgetPassHandler}) => {\r\n\r\n    const [forgotEmailState, setForgotEmailStste] = useState({value:'', valid:true});\r\n    const {openSuccessNotification, openErrorNotification} = NotificationHook();\r\n\r\n    const onChangeForgotEmail = ({target: {value}}) => {\r\n        setForgotEmailStste({...forgotEmailState, valid: true, value: value});\r\n    }\r\n\r\n    const forgotWinOk = () => {        \r\n        if(!/^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$/.test(forgotEmailState.value)){\r\n            setForgotEmailStste({...forgotEmailState, valid: false});\r\n        }else{\r\n            axios.post(`${DEFAULT_CONFIG.server}/users/forgot`, {\r\n                email: forgotEmailState.value,\r\n                hostname: window.location.host\r\n            })\r\n            .then(resp => {\r\n                if(resp.status === 201){\r\n                    // Send a notification\r\n                    openSuccessNotification(text.emailSended[idioma]);\r\n                }\r\n                forgetPassHandler();\r\n\r\n            })\r\n            .catch(err => {\r\n                if(!err.response){\r\n                    openErrorNotification(text.connError[idioma]);\r\n                }else if(err.response.status === 404){\r\n                    openErrorNotification(text.emailNotFound[idioma]);\r\n                }else{\r\n                    openErrorNotification(text.error[idioma]);\r\n                }\r\n            });\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n        }\r\n    }\r\n\r\n    return <ForgotPassView \r\n        idioma={idioma}\r\n        forgotWinState={forgotWinState}\r\n        onChangeForgotEmail={onChangeForgotEmail}\r\n        forgotWinOk={forgotWinOk}\r\n        forgotEmailState={forgotEmailState}\r\n        setForgotEmailStste={setForgotEmailStste}\r\n        forgetPassHandler={forgetPassHandler}\r\n    />;\r\n\r\n}\r\nexport default ForgotPassController;","import React from 'react';\r\nimport ForgotPassController from './forgotPass.controller';\r\n\r\nconst ForgotPass = props => {\r\n\r\n    return <ForgotPassController {...props}/>;\r\n\r\n}\r\nexport default ForgotPass;","import React from 'react';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport Link from '@material-ui/core/Link';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Container from '@material-ui/core/Container';\r\nimport {Link as RouterLink} from 'react-router-dom';\r\nimport ForgotPass from './forgotpass';\r\nimport text from './idioma.json'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  paper: {\r\n    marginTop: theme.spacing(8),\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.secondary.main,\r\n  },\r\n  form: {\r\n    width: '100%', // Fix IE 11 issue.\r\n    marginTop: theme.spacing(1),\r\n  },\r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2),\r\n  },\r\n  link: {\r\n    cursor: 'pointer',\r\n    textDecoration: 'none',\r\n    color: theme.palette.text.secondary,\r\n    '&:hover':{\r\n        textDecoration: 'underline',\r\n    }\r\n  }\r\n}));\r\n\r\nexport default function SignIn({idioma, emailRef, passRef, onSignIn, rememberChecked, onRememberChange, \r\n  forgetPassHandler, forgotWinState}) {\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"xs\">\r\n      <CssBaseline />\r\n      <div className={classes.paper}>\r\n        <Avatar className={classes.avatar}>\r\n          <LockOutlinedIcon />\r\n        </Avatar>\r\n        <Typography component=\"h1\" variant=\"h5\">\r\n          {text.signin[idioma]}\r\n        </Typography>\r\n        <form className={classes.form} noValidate>\r\n          <TextField\r\n            variant=\"outlined\"\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            id=\"email\"\r\n            label={text.email[idioma]}\r\n            name=\"email\"\r\n            autoComplete=\"email\"\r\n            autoFocus\r\n            inputRef={emailRef}\r\n          />\r\n          <TextField\r\n            variant=\"outlined\"\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            name=\"password\"\r\n            label={text.password[idioma]}\r\n            type=\"password\"\r\n            id=\"password\"\r\n            autoComplete=\"current-password\"\r\n            inputRef={passRef}\r\n          />\r\n          <FormControlLabel\r\n            control={<Checkbox value=\"remember\" color=\"primary\" checked={rememberChecked} onChange={onRememberChange}/>}\r\n            label={text.rememberme[idioma]}\r\n          />\r\n          <Button\r\n            type=\"submit\"\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            className={classes.submit}\r\n            onClick={onSignIn}            \r\n          >\r\n            {text.signin[idioma]}\r\n          </Button>\r\n          <Grid container>\r\n            <Grid item xs>\r\n              <Link className={classes.link} onClick={forgetPassHandler}>\r\n                {text.forgotpassword[idioma]}\r\n              </Link>\r\n            </Grid>\r\n            <Grid item>\r\n                {\r\n                <RouterLink to=\"/signup\" /*style={{textDecoration: 'none'}}*/ className={classes.link}>\r\n                    \r\n                    {text.gosignup[idioma]}\r\n                    \r\n                </RouterLink>\r\n                }\r\n            </Grid>\r\n          </Grid>\r\n        </form>\r\n      </div>\r\n      <ForgotPass idioma={idioma} forgotWinState={forgotWinState} forgetPassHandler={forgetPassHandler}/>\r\n\r\n    </Container>\r\n  );\r\n}","import React, {useRef, useEffect, useState} from 'react';\r\nimport axios from 'axios';\r\nimport {Redirect} from 'react-router-dom';\r\nimport {useSetRecoilState, useRecoilState} from 'recoil';\r\nimport {idiomaState, /*authTokenState,*/ userAvatarState, loginData, tokenTimeoutAtom} from '../../components/recoil/atoms';\r\nimport Signin from \"./signin.view\";\r\nimport {DEFAULT_CONFIG} from '../../conf/configuration';\r\nimport NotificationHook from '../../components/uiComponents/notification/notification.hook';\r\nimport text from './idioma.json';\r\nimport authMiddleware from '../../authMiddleware';\r\n\r\nconst SigninController = props => {\r\n\r\n    const [idioma, setIdiomaState] = useRecoilState(idiomaState);\r\n    //const setAuthTokenState = useSetRecoilState(authTokenState);\r\n    const setUserAvatarState = useSetRecoilState(userAvatarState);\r\n    const setTokenTimeOut = useSetRecoilState(tokenTimeoutAtom);\r\n    const setLoginData = useSetRecoilState(loginData);\r\n    const [redirectState, setRedirect] = useState(null);\r\n    const {openErrorNotification} = NotificationHook();\r\n    const emailRef = useRef('');\r\n    \r\n    const passRef = useRef('');\r\n    const [remember, setRemember] = useState(false);\r\n    const [forgotWinState, setforgotWinState] = useState(false);\r\n\r\n    useEffect(() => {\r\n        \r\n        const optimisticAction = token => {\r\n            axios.post(`${DEFAULT_CONFIG.server}/users/loginWithToken`,{\r\n                token: token\r\n            })\r\n            .then(resp => {\r\n                if(resp.status === 200){\r\n                    const {\r\n                        token, token_expires, _id, nickname, firstName,\r\n                        lastName, email, gender, language, avatarUrl\r\n                    } = resp.data;\r\n    \r\n                    \r\n                    localStorage.setItem('token', token);\r\n                    localStorage.setItem('token_expires', token_expires);\r\n                    setTokenTimeOut({\r\n                        timeleft: token_expires\r\n                    });\r\n    \r\n                    setLoginData({\r\n                        userId: _id, \r\n                        nickname: nickname,\r\n                        firstName: firstName,\r\n                        lastName: lastName,\r\n                        email: email,\r\n                        gender: gender\r\n                    });\r\n                    setIdiomaState(language);\r\n                    if(avatarUrl)\r\n                        //setUserAvatarState(`${DEFAULT_CONFIG.server}${avatarUrl}`);\r\n                        setUserAvatarState(avatarUrl); // Porque aqui viene el avatar completo en base64\r\n\r\n                    setRedirect(true);\r\n                }\r\n            })\r\n            .catch(err => {\r\n                if(!err.response){\r\n                    openErrorNotification(text.connErr[idioma]);\r\n                }else if(err.response.status === 403){\r\n                    openErrorNotification(text.notAuthorized[idioma]);\r\n                }else{\r\n                    openErrorNotification(text.internalError[idioma]);\r\n                }\r\n            })\r\n        }\r\n        \r\n        authMiddleware(optimisticAction);\r\n\r\n\r\n\r\n        if(localStorage.email && localStorage.password && localStorage.rememberme){\r\n            emailRef.current.value = localStorage.email;\r\n            passRef.current.value = localStorage.password;\r\n            setRemember(true);\r\n        }\r\n    },[])\r\n\r\n    const forgetPassHandler = () => {\r\n        setforgotWinState(!forgotWinState);\r\n    }\r\n\r\n    \r\n\r\n    const onSignIn = (event) => {\r\n        event.preventDefault();\r\n        \r\n        if(remember === true){\r\n            localStorage.setItem('email', emailRef.current.value);\r\n            localStorage.setItem('password', passRef.current.value);\r\n            localStorage.setItem('rememberme', true);\r\n        }else{\r\n            localStorage.removeItem('email');\r\n            localStorage.removeItem('password');\r\n            localStorage.removeItem('rememberme');\r\n        }\r\n\r\n        axios.post(`${DEFAULT_CONFIG.server}/users/login`, {\r\n            email: emailRef.current.value,\r\n            password: passRef.current.value\r\n        })\r\n        .then(resp => {\r\n            if(resp.status === 200){\r\n                \r\n                const {\r\n                    token, token_expires, _id, nickname, firstName,\r\n                    lastName, email, gender, language, avatarUrl,\r\n                    refresh_token, refresh_token_expires\r\n                } = resp.data;\r\n\r\n                \r\n                localStorage.setItem('token', token);\r\n                localStorage.setItem('refresh_token', refresh_token);\r\n                localStorage.setItem('token_expires', token_expires);\r\n                localStorage.setItem('refresh_token_expires', refresh_token_expires);\r\n                setTokenTimeOut({\r\n                    timeleft: token_expires\r\n                });\r\n\r\n                setLoginData({\r\n                    userId: _id, \r\n                    nickname: nickname,\r\n                    firstName: firstName,\r\n                    lastName: lastName,\r\n                    email: email,\r\n                    gender: gender\r\n                });\r\n                setIdiomaState(language);\r\n                if(avatarUrl)\r\n                    //setUserAvatarState(`${DEFAULT_CONFIG.server}${avatarUrl}`);\r\n                    setUserAvatarState(avatarUrl); // Porque aqui viene el avatar completo en base64\r\n\r\n                setRedirect(true);\r\n\r\n            }\r\n        })\r\n        .catch(err => {\r\n            \r\n            if(!err.response){\r\n                openErrorNotification(text.connErr[idioma]);\r\n            }else if(err.response.message === \"User not active\") {\r\n                openErrorNotification(text.notActive[idioma]);\r\n            } else if(err.response.status === 403){\r\n                openErrorNotification(text.notAuthorized[idioma]);\r\n            }else{\r\n                openErrorNotification(text.internalError[idioma]);\r\n            }\r\n        });\r\n    }\r\n\r\n    if(redirectState){\r\n        return <Redirect to=\"/contacts\" />\r\n    }\r\n    \r\n    return <Signin idioma={idioma} \r\n        emailRef={emailRef}\r\n        passRef={passRef}\r\n        rememberChecked={remember}\r\n        onRememberChange={event => setRemember(event.target.checked)}\r\n        onSignIn={onSignIn}\r\n        forgotWinState={forgotWinState}\r\n        forgetPassHandler={forgetPassHandler}\r\n    />;\r\n\r\n}\r\n\r\nexport default SigninController;\r\n","import React from 'react';\r\nimport SigninController from './signin.controller';\r\nconst Signin = props => {\r\n\r\n    return <SigninController />;\r\n\r\n}\r\nexport default Signin;","import React from 'react';\r\n\r\nimport Container from '@material-ui/core/Container';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    container: {\r\n      padding: 0,\r\n      position: 'relative',\r\n      height: '100vh',\r\n      overflowY: 'hidden',\r\n      backgroundColor: theme.palette.background.paper\r\n    },\r\n    background: {\r\n        backgroundColor: theme.palette.background.default\r\n    }\r\n  }));\r\n\r\nconst MainView = props => {\r\n    const classes = useStyles();\r\n\r\n    return (\r\n        <div className={classes.background}>\r\n            <Container maxWidth=\"sm\" className={classes.container} component=\"main\">\r\n                <CssBaseline />\r\n                {props.children}\r\n            </Container>\r\n        </div>\r\n    );\r\n\r\n}\r\nexport default MainView;","import React from 'react';\r\nimport ContainerView from './main.view';\r\nconst MainContainer = props => {\r\n\r\n    return <ContainerView {...props}/>;\r\n\r\n}\r\nexport default MainContainer;","import React from 'react';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Container from '@material-ui/core/Container';\r\nimport {Link as RouterLink} from 'react-router-dom';\r\n\r\nimport text from './idioma.json';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  paper: {\r\n    marginTop: theme.spacing(8),\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.secondary.main,\r\n  },\r\n  form: {\r\n    width: '100%', // Fix IE 11 issue.\r\n    marginTop: theme.spacing(3),\r\n  },\r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2),\r\n  },\r\n  link: {\r\n    cursor: 'pointer',\r\n    textDecoration: 'none',\r\n    color: theme.palette.text.secondary,\r\n    '&:hover':{\r\n        textDecoration: 'underline',\r\n    }\r\n  }\r\n}));\r\n\r\nexport default function SignUp({idioma, onSignUp,emailState, onEmailChange, passState, onPassChange, nameState, onNameChange, lastNameRef}) {\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"xs\">\r\n      <CssBaseline />\r\n      <div className={classes.paper}>\r\n        <Avatar className={classes.avatar}>\r\n          <LockOutlinedIcon />\r\n        </Avatar>\r\n        <Typography component=\"h1\" variant=\"h5\">\r\n          {text.signup[idioma]}\r\n        </Typography>\r\n        <form className={classes.form} noValidate>\r\n          <Grid container spacing={2}>\r\n            <Grid item xs={12} sm={6}>\r\n              <TextField\r\n                autoComplete=\"fname\"\r\n                name=\"firstName\"\r\n                variant=\"outlined\"\r\n                required\r\n                fullWidth\r\n                id=\"firstName\"\r\n                label={text.firstName[idioma]}\r\n                autoFocus\r\n                value={nameState.value}\r\n                helperText={!nameState.valid ? text[nameState.msg][idioma] : ''}\r\n                error={!nameState.valid}\r\n                onChange={onNameChange}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={12} sm={6}>\r\n              <TextField\r\n                variant=\"outlined\"\r\n                fullWidth\r\n                id=\"lastName\"\r\n                label={text.lastName[idioma]}\r\n                name=\"lastName\"\r\n                autoComplete=\"lname\"\r\n                inputRef={lastNameRef}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={12}>\r\n              <TextField\r\n                variant=\"outlined\"\r\n                required\r\n                fullWidth\r\n                id=\"email\"\r\n                label={text.email[idioma]}\r\n                name=\"email\"\r\n                autoComplete=\"email\"\r\n                value={emailState.value}\r\n                helperText={!emailState.valid ? text.invalidEmail[idioma] : ''}\r\n                error={!emailState.valid}\r\n                onChange={onEmailChange}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={12}>\r\n              <TextField\r\n                variant=\"outlined\"\r\n                required\r\n                fullWidth\r\n                name=\"password\"\r\n                label={text.password[idioma]}\r\n                type=\"password\"\r\n                id=\"password\"\r\n                autoComplete=\"current-password\"\r\n                value={passState.value}\r\n                helperText={!passState.valid ? text[passState.msg][idioma] : ''}\r\n                error={!passState.valid}\r\n                onChange={onPassChange}\r\n              />\r\n            </Grid>            \r\n          </Grid>\r\n          <Button\r\n            type=\"submit\"\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            className={classes.submit}\r\n            onClick={onSignUp}\r\n          >\r\n            {text.signup[idioma]}\r\n          </Button>\r\n          <Grid container justify=\"flex-end\">\r\n            <Grid item>\r\n              <RouterLink to=\"/\" className={classes.link}>\r\n              {text.signin[idioma]}\r\n              </RouterLink>\r\n            </Grid>\r\n          </Grid>\r\n        </form>\r\n      </div>\r\n    </Container>\r\n  );\r\n}","import React, {useState, useRef} from 'react';\r\nimport axios from 'axios';\r\nimport {DEFAULT_CONFIG} from '../../conf/configuration';\r\nimport Signup from './signup.view';\r\nimport {useRecoilValue} from 'recoil';\r\nimport {idiomaState} from '../../components/recoil/atoms';\r\nimport NotificationHook from '../../components/uiComponents/notification/notification.hook';\r\nimport text from './idioma.json';\r\n\r\nconst SignupController = props => {\r\n    \r\n    const idioma = useRecoilValue(idiomaState);\r\n    const {openSuccessNotification, openErrorNotification} = NotificationHook();\r\n    const [emailState, setEmailState] = useState({value: \"\", valid: true});\r\n    const [passState, setPassState] = useState({value: \"\", valid: true});    \r\n    const [nameState, setNameState] = useState({value: \"\", valid: true});    \r\n    \r\n    const lastNameRef = useRef();\r\n\r\n    const onSignUp = (event) => {\r\n        event.preventDefault();\r\n        if(!/^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$/.test(emailState.value)){\r\n            setEmailState({...emailState, valid: false});\r\n        }else\r\n        if(passState.value.length < 8){\r\n            setPassState({...passState, valid: false, msg: 'passShort'});\r\n        }else\r\n\r\n        if(!/^[a-zA-Z\\']+$/.test(nameState.value)){\r\n            setNameState({...nameState, valid: false, msg: 'nameInvalid'});\r\n        }else\r\n        if(nameState.value.length < 2){\r\n            setNameState({...nameState, valid: false, msg: 'nameShort'});\r\n        }else\r\n        if(nameState.value.length >= 20){\r\n            setNameState({...nameState, valid: false, msg: 'nameLong'});\r\n        }else {\r\n            // All validations pass!\r\n            axios.post(`${DEFAULT_CONFIG.server}/users/signup`, {\r\n                firstName: nameState.value,\r\n                lastName: lastNameRef.current.value,\r\n                email: emailState.value,\r\n                password: passState.value,\r\n                language: idioma,\r\n                hostname: window.location.host\r\n            })\r\n            .then(resp => {\r\n                if(resp.status === 201){\r\n                    // Send a notification\r\n                    openSuccessNotification(text.userCreated[idioma]);\r\n                }\r\n            })\r\n            .catch(err => {\r\n                if(!err.response){\r\n                    openErrorNotification(text.connError[idioma]);\r\n                }else if(err.response.status === 409){\r\n                    openErrorNotification(text.duplicated[idioma]);\r\n                }else{\r\n                    openErrorNotification(text.error[idioma]);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    const onNameChange = ({target: {value}}) => {\r\n        setNameState({...nameState, value: value, valid: true});\r\n    }\r\n    const onEmailChange = ({target:{value}}) => {\r\n        setEmailState({...emailState, value: value, valid: true});\r\n    }\r\n    const onPassChange = ({target: {value}}) => {\r\n        setPassState({...passState, value: value, valid: true});\r\n    }\r\n\r\n    return (\r\n        <Signup \r\n            idioma={idioma}\r\n           \r\n            \r\n            lastNameRef={lastNameRef}\r\n            nameState={nameState}\r\n            passState={passState}\r\n            emailState={emailState}\r\n            onSignUp={onSignUp}\r\n            onNameChange={onNameChange}\r\n            onEmailChange={onEmailChange}\r\n            onPassChange={onPassChange}\r\n        />\r\n    );\r\n\r\n}\r\nexport default SignupController;","import React from 'react';\r\nimport SignupController from './signup.controller';\r\n\r\nconst Signup = props => {\r\n\r\n    return <SignupController />;\r\n\r\n}\r\nexport default Signup;","import React from 'react';\r\nimport {useRecoilState} from 'recoil';\r\nimport {Snackbar } from '@material-ui/core';\r\nimport MuiAlert from '@material-ui/lab/Alert';\r\n\r\n\r\nimport {notificationAtom} from './notification.atom';\r\n\r\n\r\n\r\n\r\nfunction Alert(props) {\r\n    return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\r\n  }\r\n\r\nconst NotificationView = () => {\r\n    const [notificationState, setNotState] = useRecoilState(notificationAtom);\r\n    \r\n\r\n    const handleClose = (event, reason) => {\r\n        if (reason === 'clickaway') {\r\n          return;\r\n        }\r\n        setNotState({...notificationState, open: false});\r\n    };\r\n\r\n    return <Snackbar \r\n        open={notificationState.open}\r\n        autoHideDuration={notificationState.autoHideDuration}\r\n        onClose={handleClose}\r\n        anchorOrigin={{ vertical:'top', horizontal:'center' }}\r\n    >\r\n        <Alert\r\n            onClose={handleClose}\r\n            severity={notificationState.severity}\r\n        >\r\n            {notificationState.msg}\r\n        </Alert>\r\n    </Snackbar>;\r\n\r\n}\r\nexport default NotificationView;","import React from 'react';\r\nimport NotificationView from './notification/notification.view';\r\n//import Backdrop from './backdrop/backdrop.view';\r\n\r\nconst Notification = props => {\r\n\r\n    return (\r\n        <>\r\n            <NotificationView />\r\n            {/*<Backdrop />*/}\r\n        </>\r\n    );\r\n\r\n}\r\n\r\nexport default Notification;","//import React from 'react';\r\nimport {useSetRecoilState} from 'recoil';\r\nimport axios from 'axios';\r\nimport {tokenTimeoutAtom} from '../components/recoil/atoms';\r\nimport useLogout from './useLogout';\r\nimport {DEFAULT_CONFIG} from '../conf/configuration'\r\nimport { useCallback } from 'react';\r\n\r\nconst useRefreshToken = () => {\r\n\r\n    const setTokenTimeout = useSetRecoilState(tokenTimeoutAtom);\r\n    const logout = useLogout();\r\n    \r\n    const refreshToken = useCallback(() => {\r\n        const token = localStorage.getItem('token');\r\n        const refresh_token = localStorage.getItem('refresh_token');\r\n        const refresh_token_expires = localStorage.getItem('refresh_token_expires');\r\n        if (refresh_token && refresh_token_expires && new Date(refresh_token_expires).getTime() > new Date().getTime()) {\r\n            \r\n            return axios.post(`${DEFAULT_CONFIG.server}/users/refreshtoken`, {\r\n                token: token, refresh_token: refresh_token\r\n              })\r\n              .then(resp => {\r\n                if(resp.status === 200){\r\n                  const {new_token, new_refresh_token, new_token_expires, new_refresh_token_expires} = resp.data;\r\n                  localStorage.setItem('token', new_token);\r\n                  localStorage.setItem('refresh_token', new_refresh_token);\r\n                  localStorage.setItem('token_expires', new_token_expires);\r\n                  localStorage.setItem('refresh_token_expires', new_refresh_token_expires);\r\n                  setTokenTimeout({\r\n                        timeleft: new_token_expires\r\n                  })\r\n                }          \r\n              })\r\n              .catch(err => {\r\n                  logout();\r\n              });\r\n    \r\n        }else{\r\n            logout();\r\n        }\r\n    }, [logout, setTokenTimeout])\r\n    \r\n    return refreshToken;\r\n  }\r\n\r\n  export default useRefreshToken;","import React, {Suspense} from 'react';\r\nimport {useRecoilValue} from 'recoil';\r\n\r\n// Recoil Atoms\r\nimport {subscribeToEventsState, loginData, activeChatWith, tokenTimeoutAtom, darkModeAtom} from './components/recoil/atoms';\r\n\r\n// React router\r\nimport {Switch, Route, Redirect} from 'react-router-dom';\r\n\r\n// Materia UI\r\nimport { createMuiTheme, makeStyles } from '@material-ui/core/styles';\r\nimport { ThemeProvider } from '@material-ui/styles';\r\nimport Backdrop from '@material-ui/core/Backdrop';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport {SnackbarProvider} from 'notistack';\r\n\r\n// Componentes visuales\r\nimport Signin from './view/signin';\r\nimport MainContainter from './view/main';\r\nimport Signup from './view/signup';\r\nimport UiComponents from './components/uiComponents';\r\nimport useRefreshToken from './utils/useRefreshToken';\r\n\r\n\r\n\r\n//import Toolbar from './view/toolbar';\r\n//import MainButton from './view/mainButton';\r\n//import ContactList from './view/contacts';\r\n//import ChatCmp from './view/chat';\r\n//import ActivateUser from './view/activateuser';\r\n//import Events from './components/events';\r\n//import ChangePass from './view/changepass';\r\n\r\nconst AsyncToolbar = React.lazy(() => import('./view/toolbar'));\r\nconst AsyncMainButton = React.lazy(() => import('./view/mainButton'));\r\nconst AsyncContactList = React.lazy(() => import('./view/contacts'));\r\nconst AsyncChatCmp = React.lazy(() => import('./view/chat'));\r\nconst AsyncActivateUser = React.lazy(() => import('./view/activateuser'));\r\nconst AsyncChangePass = React.lazy(() => import('./view/changepass'));\r\nconst AsyncEvents = React.lazy(() => import('./components/events'));\r\n\r\n\r\n\r\nconst TimerCmp = () => {\r\n\r\n    const refreshToken = useRefreshToken();\r\n    const timeoutData = useRecoilValue(tokenTimeoutAtom);\r\n    \r\n    React.useEffect(() => {\r\n        \r\n        let timeleft = new Date(timeoutData.timeleft).getTime() - new Date().getTime();\r\n        if(timeleft >= 10000){\r\n            setTimeout(()=> {\r\n                refreshToken();\r\n            }, timeleft - 10000);\r\n        }\r\n\r\n    }, [timeoutData]);\r\n\r\n    return <></>;\r\n}\r\n\r\nconst themeDark = createMuiTheme({palette: {type: 'dark',}});\r\nconst themeDefault = createMuiTheme({});\r\n\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  backdrop: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    color: '#fff',\r\n  },\r\n}));\r\n\r\n\r\nconst App = () => {\r\n\r\n    const classes = useStyles();\r\n\r\n    const dark = useRecoilValue(darkModeAtom);\r\n    const subscribe = useRecoilValue(subscribeToEventsState);\r\n    const userData = useRecoilValue(loginData);\r\n    const chatWith = useRecoilValue(activeChatWith);\r\n    const notistackRef = React.createRef();\r\n    const onClickDismiss = key => () => { \r\n        notistackRef.current.closeSnackbar(key);\r\n    }\r\n  \r\n    const cmp  = userData !== null \r\n    ? <>\r\n            {\r\n                chatWith \r\n                ? <AsyncChatCmp />\r\n                : <Route path=\"/contacts\" exact render={ () => (\r\n                    <ThemeProvider theme={dark ? themeDark : themeDefault}>\r\n                        <AsyncToolbar />\r\n                        <AsyncContactList />\r\n                        <AsyncMainButton />\r\n                    </ThemeProvider>\r\n                )} />\r\n            }\r\n        </> \r\n    : null ;\r\n\r\n\r\n    return (\r\n        <Suspense fallback={\r\n            <Backdrop className={classes.backdrop} open={true} >\r\n                <CircularProgress color=\"inherit\" />\r\n            </Backdrop>}\r\n        >\r\n        <ThemeProvider theme={dark ? themeDark : themeDefault}>       \r\n            <MainContainter>\r\n                <CssBaseline />\r\n                <UiComponents />\r\n                <SnackbarProvider \r\n                    maxSnack={3} \r\n                    autoHideDuration={3000}\r\n                    preventDuplicate\r\n                    anchorOrigin={{\r\n                        vertical: 'top',\r\n                        horizontal: 'left',\r\n                    }}\r\n                    ref={notistackRef}\r\n                    action={(key) => (\r\n                        <IconButton onClick={onClickDismiss(key)}>\r\n                            <CloseIcon fontSize=\"small\" style={{color: 'white'}} />\r\n                        </IconButton>\r\n                    )}\r\n                >\r\n                    <Switch>\r\n                        <Route path=\"/\" exact component={Signin} />\r\n                        <Route path=\"/signup\" exact component={Signup} />\r\n                        {cmp}\r\n                        <Route path=\"/changepass/:token\" exact render={() => (\r\n                            \r\n                                <AsyncChangePass />\r\n                            \r\n                        )} />\r\n                        \r\n                        \r\n                        \r\n                        <Route path=\"/activateuser/:token/:nickname/:invited\" exact render={() => (\r\n                            \r\n                                <AsyncActivateUser />\r\n                            \r\n                        )} /> \r\n                        <Route path=\"/activateuser/:token/:nickname\" exact render={() => (\r\n                            \r\n                                <AsyncActivateUser />\r\n                            \r\n                        )} /> \r\n                        \r\n                        \r\n                        \r\n                        \r\n                        <Redirect from='/' to='/' />       \r\n                    </Switch>\r\n                    \r\n                    {subscribe ? \r\n                        \r\n                            <AsyncEvents />\r\n                        \r\n                    : null\r\n                    }\r\n                    <TimerCmp />\r\n                </SnackbarProvider>\r\n            </MainContainter>\r\n        </ThemeProvider>\r\n    </Suspense>   \r\n     \r\n    );\r\n}\r\n\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport {RecoilRoot} from 'recoil';\r\nimport { BrowserRouter } from 'react-router-dom';\r\n//import 'typeface-roboto';\r\n//import 'fontsource-roboto';\r\n//import \"fontsource-roboto/300.css\"\r\n//import \"fontsource-roboto/400.css\"\r\n//import \"fontsource-roboto/500.css\"\r\n//import \"fontsource-roboto/700.css\"\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <RecoilRoot>\r\n      <BrowserRouter>\r\n        <App />\r\n      </BrowserRouter>      \r\n    </RecoilRoot>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\n//serviceWorker.unregister();\r\nserviceWorker.register();\r\n","const DEV = {\r\n    server: \"http://localhost:3001\"\r\n}\r\nconst PROD = {\r\n    // eslint-disable-next-line no-restricted-globals\r\n    server: location.origin //\"https://shut-app-back.herokuapp.com\"\r\n}\r\n\r\nexport const DEFAULT_CONFIG = process.env.NODE_ENV === \"development\" ? DEV : PROD;","import React from 'react';\r\nimport {useRecoilState} from 'recoil'\r\nimport {notificationAtom} from './notification.atom';\r\n\r\n\r\nconst NotificationHook = () => {\r\n    \r\n    const [notificationState, setNotificationState] = useRecoilState(notificationAtom);\r\n\r\n    const defaultToOpem = {\r\n        ...notificationState,\r\n        open: true,\r\n        autoHideDuration: 3000\r\n    };\r\n\r\n    const openNotification = properties => {\r\n        setNotificationState({\r\n            ...defaultToOpem,\r\n            ...properties\r\n        });\r\n    }\r\n\r\n    const openSpecificNotification = (severity, msg) => {\r\n        setNotificationState({\r\n            ...defaultToOpem,\r\n            severity: severity,\r\n            msg: msg\r\n        });\r\n    }\r\n\r\n    const openSuccessNotification = msg => {\r\n        openSpecificNotification(\"success\",msg);\r\n    }\r\n\r\n    const openWarningNotification = msg => {\r\n        openSpecificNotification(\"warning\",msg);\r\n    }\r\n\r\n    const openErrorNotification = msg => {\r\n        openSpecificNotification(\"error\",msg);\r\n    }\r\n\r\n    const openInfoNotification = msg => {\r\n        openSpecificNotification(\"info\",msg);\r\n    }\r\n\r\n    return {    \r\n        openNotification: openNotification,\r\n        openSuccessNotification: openSuccessNotification,\r\n        openErrorNotification: openErrorNotification,\r\n        openInfoNotification: openInfoNotification,\r\n        openWarningNotification: openWarningNotification\r\n    };\r\n\r\n}\r\nexport default NotificationHook;","import {atom} from 'recoil';\r\n\r\nconst notificationAtom = atom({\r\n    key: \"notificationAtom\",\r\n    default: {\r\n        open: false,\r\n        autoHideDuration: 6000,\r\n        severity: 'success',\r\n        msg: \"\"\r\n    }\r\n});\r\n\r\nexport {notificationAtom};"],"sourceRoot":""}