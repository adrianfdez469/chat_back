(this.webpackJsonpchat_front=this.webpackJsonpchat_front||[]).push([[9],{324:function(e,t,a){"use strict";var n=a(16),o=a.n(n),r=a(34),c=a(24),i=a(14);t.a=function(){var e=Object(c.a)(),t=e.openErrorNotification,a=e.openSuccessNotification;return{postRequest:function(e){var n=e.url,c=e.bodyParams,s=void 0===c?{}:c,l=e.doFnAfterSuccess,u=void 0===l?null:l,d=e.doFnAfterError,p=void 0===d?null:d,m=e.messageOnSuccess,f=void 0===m?null:m,g=e.messageOnError,b=void 0===g?null:g;Object(r.a)((function(e){o.a.post("".concat(i.a.server).concat(n),s,{headers:{Authorization:e}}).then((function(t){f&&a(f),u&&u(t,e)})).catch((function(e){b&&t(b),p&&p(e)}))}))}}}},369:function(e,t,a){"use strict";var n=a(1),o=a(2),r=a(0),c=(a(7),a(3)),i=a(5),s=a(9),l=a(112),u=r.forwardRef((function(e,t){var a=e.classes,i=e.className,u=e.color,d=void 0===u?"primary":u,p=e.position,m=void 0===p?"fixed":p,f=Object(o.a)(e,["classes","className","color","position"]);return r.createElement(l.a,Object(n.a)({square:!0,component:"header",elevation:4,className:Object(c.a)(a.root,a["position".concat(Object(s.a)(m))],a["color".concat(Object(s.a)(d))],i,"fixed"===m&&"mui-fixed"),ref:t},f))}));t.a=Object(i.a)((function(e){var t="light"===e.palette.type?e.palette.grey[100]:e.palette.grey[900];return{root:{display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",zIndex:e.zIndex.appBar,flexShrink:0},positionFixed:{position:"fixed",top:0,left:"auto",right:0,"@media print":{position:"absolute"}},positionAbsolute:{position:"absolute",top:0,left:"auto",right:0},positionSticky:{position:"sticky",top:0,left:"auto",right:0},positionStatic:{position:"static"},positionRelative:{position:"relative"},colorDefault:{backgroundColor:t,color:e.palette.getContrastText(t)},colorPrimary:{backgroundColor:e.palette.primary.main,color:e.palette.primary.contrastText},colorSecondary:{backgroundColor:e.palette.secondary.main,color:e.palette.secondary.contrastText},colorInherit:{color:"inherit"},colorTransparent:{backgroundColor:"transparent",color:"inherit"}}}),{name:"MuiAppBar"})(u)},370:function(e,t,a){"use strict";var n=a(1),o=a(2),r=a(13),c=a(0),i=(a(7),a(3)),s=a(5),l=c.forwardRef((function(e,t){var a=e.classes,r=e.className,s=e.component,l=void 0===s?"div":s,u=e.disableGutters,d=void 0!==u&&u,p=e.variant,m=void 0===p?"regular":p,f=Object(o.a)(e,["classes","className","component","disableGutters","variant"]);return c.createElement(l,Object(n.a)({className:Object(i.a)(a.root,a[m],r,!d&&a.gutters),ref:t},f))}));t.a=Object(s.a)((function(e){return{root:{position:"relative",display:"flex",alignItems:"center"},gutters:Object(r.a)({paddingLeft:e.spacing(2),paddingRight:e.spacing(2)},e.breakpoints.up("sm"),{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}),regular:e.mixins.toolbar,dense:{minHeight:48}}}),{name:"MuiToolbar"})(l)},387:function(e,t,a){"use strict";var n=a(95);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(a(0)),r=(0,n(a(114)).default)(o.default.createElement("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}),"ArrowBack");t.default=r},388:function(e,t,a){"use strict";var n=a(95);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(a(0)),r=(0,n(a(114)).default)(o.default.createElement("path",{d:"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"}),"Done");t.default=r},389:function(e,t,a){"use strict";var n=a(95);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(a(0)),r=(0,n(a(114)).default)(o.default.createElement("path",{d:"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"}),"DoneAll");t.default=r},390:function(e){e.exports=JSON.parse('{"errorLoadConversation":{"es":"Error al cargar mensajes","en":"Error loading messages"}}')},391:function(e,t,a){"use strict";var n=a(95);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(a(0)),r=(0,n(a(114)).default)(o.default.createElement("path",{d:"M9.78 18.65l.28-4.23 7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3 3.64 12c-.88-.25-.89-.86.2-1.3l15.97-6.16c.73-.33 1.43.18 1.15 1.3l-2.72 12.81c-.19.91-.74 1.13-1.5.71L12.6 16.3l-1.99 1.93c-.23.23-.42.42-.83.42z"}),"Telegram");t.default=r},392:function(e){e.exports=JSON.parse('{"notEditable":{"es":"No puede enviar mensajes a este usuario","en":"Can\'t send messages to this user"}}')},433:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(15),c=a(4),i=a(23),s=a(8),l=a(65),u=a(369),d=a(370),p=a(322),m=a(94),f=a(260),g=a(354),b=a(296),v=a(5),h=a(92),x=a(90),O=a(387),E=a.n(O),j=a(339),y=a.n(j),k=a(14),S=Object(b.a)((function(e){var t;return{grow:{flexGrow:1},menuButton:{marginRight:e.spacing(.5)},title:{display:"block",marginLeft:e.spacing(1)},customAppBar:(t={width:"100%"},Object(l.a)(t,e.breakpoints.up("sm"),{width:e.breakpoints.values.sm}),Object(l.a)(t,"right","auto"),t),avatarMan:{color:e.palette.getContrastText(h.a[400]),backgroundColor:h.a[400]},avatarWoman:{color:e.palette.getContrastText(x.a[300]),backgroundColor:x.a[300]}}})),w=Object(v.a)((function(e){return{badge:{backgroundColor:"#44b700",color:"#44b700",boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(g.a),I=Object(v.a)((function(e){return{badge:{backgroundColor:e.palette.grey[500],color:e.palette.grey[500],boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(g.a),N=function(e){return e.contact.socketId&&1===e.contact.friendShipStatus?o.a.createElement(w,{overlap:"circle",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot"},e.children):o.a.createElement(I,{overlap:"circle",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot"},e.children)},R=function(e){var t=e.closeChat,a=e.contact,n=S(),r=a.avatarUrl?k.a.server+a.avatarUrl:null,c="M"===a.gender?"avatarMan":"avatarWoman";return o.a.createElement(u.a,{position:"fixed",className:n.customAppBar},o.a.createElement(d.a,null,o.a.createElement(f.a,{edge:"start",className:n.menuButton,color:"inherit","aria-label":"open drawer",onClick:t},o.a.createElement(E.a,null)),o.a.createElement(N,{contact:a},o.a.createElement(p.a,{src:r,className:a.gender&&c})),o.a.createElement(m.a,{className:n.title,variant:"h5",noWrap:!0},a.nickname),o.a.createElement("div",{className:n.grow}),o.a.createElement(f.a,{"aria-label":"show 4 new mails",color:"inherit"},o.a.createElement(y.a,null))))},C=function(){var e=Object(c.useRecoilState)(s.a),t=Object(r.a)(e,2),a=t[0],n=t[1],l=Object(c.useRecoilValue)(i.d).find((function(e){return e.contactId===a}));return o.a.createElement(R,{closeChat:function(){n(null)},contact:l})},M=function(e){return o.a.createElement(C,null)},A=a(6),L=a(89),T={50:"#f1f8e9",100:"#dcedc8",200:"#c5e1a5",300:"#aed581",400:"#9ccc65",500:"#8bc34a",600:"#7cb342",700:"#689f38",800:"#558b2f",900:"#33691e",A100:"#ccff90",A200:"#b2ff59",A400:"#76ff03",A700:"#64dd17"},z=a(388),B=a.n(z),D=a(389),V=a.n(D),P=a(429),_=a(435),F=Object(b.a)((function(e){return{message:{padding:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px"),maxWidth:"60%",marginTop:e.spacing(2),marginBottom:0,marginLeft:"".concat(e.spacing(2),"px"),marginRight:"".concat(e.spacing(2),"px"),borderRadius:"10px",backgroundColor:e.palette.info.dark,color:e.palette.info.contrastText,position:"relative"},timeMessage:Object(A.a)({paddingLeft:e.spacing(2),maxWidth:"60%",marginBottom:e.spacing(1),marginLeft:"".concat(e.spacing(2),"px"),marginRight:"".concat(e.spacing(1),"px"),color:e.palette.text.disabled},e.typography.subtitle2),mymsg:{textAlign:"right",alignSelf:"flex-end",borderRadius:"10px 0 10px 10px"},notmymsg:{alignSelf:"flex-start",borderRadius:"0 10px 10px 10px"},msgAvatar:{width:e.spacing(3),height:e.spacing(3),position:"absolute",top:"-".concat(e.spacing(1.5),"px")},myMsgAvatar:{right:"-".concat(e.spacing(1.5),"px")},notMyMsgAvatar:{left:"-".concat(e.spacing(1.5),"px")},doneIcon:{marginRight:e.spacing(1),fontSize:e.spacing(2.2)}}})),H=o.a.memo((function(e){var t=e.state,a=e.content,n=e.datetime,r=e.contact,c=e.avatarSrc,i=e.idioma,s=F(),l=t>0?s.mymsg:s.notmymsg,u=t>0?s.myMsgAvatar:s.notMyMsgAvatar,d=t>0?c:k.a.server+r.avatarUrl,m="es"===i?{locale:_.a}:{},f=Object(P.a)(new Date(n),new Date,m),g=null;return 1===t&&(g=o.a.createElement(B.a,{className:s.doneIcon,style:{color:L.a[500]}})),2===t&&(g=o.a.createElement(V.a,{className:s.doneIcon,style:{color:L.a[500]}})),3===t&&(g=o.a.createElement(V.a,{className:s.doneIcon,style:{color:T[500]}})),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"".concat(s.message," ").concat(l)},o.a.createElement(p.a,{alt:r.nickname,src:d,variant:"circle",className:"".concat(s.msgAvatar," ").concat(u)}),a),o.a.createElement("span",{className:" ".concat(l)},o.a.createElement("span",{className:"".concat(s.timeMessage)},f),g))})),W=Object(b.a)((function(e){return{chatConversation:{position:"relative",flexGrow:1,display:"flex",flexDirection:"column",overflowY:"auto",height:"100%"},offset:e.mixins.toolbar,offsetDown:Object(A.a)(Object(A.a)({},e.mixins.toolbar),{},{bottom:0,position:"relative"})}})),G=function(e){var t=e.contact,a=e.avatarSrc,n=e.messages,r=e.idioma;o.a.useEffect((function(){var e=document.getElementById("chatConversation");e&&(e.scrollTop=e.scrollHeight)}));var c=W();return o.a.createElement("div",{id:"chatConversation",className:c.chatConversation},o.a.createElement("div",{className:c.offset}),n.map((function(e,n,c){return o.a.createElement(H,Object.assign({},e,{key:n,contact:t,avatarSrc:a,idioma:r}))})),o.a.createElement("div",{className:c.offsetDown}))},J=a(324),q=a(390),U=a(17),$=function(){var e=Object(c.useRecoilValue)(s.a),t=Object(c.useSetRecoilState)(i.e),a=Object(c.useRecoilValue)(Object(s.g)(e)),r=Object(c.useRecoilValue)(s.l),l=Object(c.useRecoilValue)(s.i),u=Object(c.useRecoilValue)(s.h),d=Object(c.useRecoilValue)(i.d),p=Object(J.a)().postRequest,m=d.find((function(t){return t.contactId===e}));return Object(n.useEffect)((function(){0===a.length&&p({url:"/messages/getMessagesByContact",messageOnError:q.errorLoadConversation[u],bodyParams:{contactId:m.contactId},doFnAfterSuccess:function(e,a){200===e.status&&(t({contactId:m.contactId,conversation:e.data.conversation}),U.a.getSocket().emit("read messages",{readerId:l.userId,messengerId:m.contactId,messengerSocketId:m.socketId,token:a}))}})}),[]),a?o.a.createElement(G,{contact:m,avatarSrc:r,messages:a,idioma:u}):null},Y=function(e){return o.a.createElement($,null)},K=a(24),Q=a(391),X=a.n(Q),Z=Object(b.a)((function(e){var t;return{appBar:(t={top:"auto",bottom:0,position:"fixed",width:"100%"},Object(l.a)(t,e.breakpoints.up("sm"),{width:e.breakpoints.values.sm}),Object(l.a)(t,"right","auto"),t),grow:{flexGrow:1},toolbar:{padding:0},icon:{fontSize:e.spacing(3.75)},textarea:{border:"1px solid white",fontFamily:"inherit",fontSize:"large",padding:"1px 6px",backgroundColor:e.palette.background.paper,color:e.palette.text.primary,width:"100%",marginTop:e.spacing(1),marginBottom:e.spacing(1),maxHeight:e.spacing(10),minHeight:e.spacing(4),overflowY:"auto",borderRadius:e.spacing(.5),marginLeft:e.spacing(2),cursor:"text"}}})),ee=function(e){var t=e.sendMessage,a=e.refAreaTexto,n=e.keyPress,r=Z();return o.a.createElement(u.a,{color:"primary",className:r.appBar},o.a.createElement(d.a,{variant:"dense",className:r.toolbar},o.a.createElement("div",{className:r.textarea,role:"textbox",contentEditable:!0,ref:a,onKeyPress:n}),o.a.createElement("div",{className:r.grow}),o.a.createElement(f.a,{color:"inherit",onClick:t},o.a.createElement(X.a,{className:r.icon}))))},te=a(392),ae=function(e){var t=Object(K.a)().openWarningNotification,a=Object(c.useRecoilValue)(s.i),l=Object(c.useRecoilValue)(s.h),u=Object(c.useSetRecoilState)(i.a),d=Object(c.useRecoilValue)(s.a),p=Object(c.useRecoilValue)(i.d).find((function(e){return e.contactId===d})),m=Object(n.useRef)(""),f=Object(n.useState)(0),g=Object(r.a)(f,2),b=g[0],v=g[1],h=function(){""!==m.current.innerText.replace(/^(\s*\r*)(.)(\s*\r*)$/,"$2")&&(u({contactId:p.contactId,messageId:b,content:m.current.innerText,datetime:new Date,state:1}),v((function(e){return e+1})),U.a.getSocket().emit("send message",{content:m.current.innerText,userOriginId:a.userId,userDestinyId:d,toSocketId:p.socketId,token:localStorage.getItem("token"),consecutive:b}),m.current.innerText="",m.current.focus())};return Object(n.useEffect)((function(){1===p.friendShipStatus?m.current.focus():t(te.notEditable[l])}),[]),1===p.friendShipStatus?o.a.createElement(ee,{sendMessage:h,keyPress:function(e){13===e.charCode&&(e.preventDefault(),h())},refAreaTexto:m}):null},ne=function(e){return o.a.createElement(ae,null)},oe=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(M,null),o.a.createElement(Y,null),o.a.createElement(ne,null))};t.default=function(e){return o.a.createElement(oe,null)}}}]);
//# sourceMappingURL=9.6a6ad8cc.chunk.js.map