(this.webpackJsonpchat_front=this.webpackJsonpchat_front||[]).push([[0],{108:function(e){e.exports=JSON.parse('{"errorLoadingFriends":{"es":"Error al cargar contactos","en":"Error while loading contacts"},"errorLoadingFriendsData":{"es":"Error al cargar datos de contactos","en":"Error while loading contacts data"},"delete":{"es":"Eliminar","en":"Delete"},"beta":{"es":"SHUT-APP V2.0.0 Beta es una aplicaci\xf3n web de chat realizada sin ning\xfan \xe1nimo de lucro. La informaci\xf3n ingresada en esta no ser\xe1 divulgada bajo ning\xfan concepto.","en":"SHUT-APP V2.0.0 Beta is a non-profit chat web application. The information entered will not be disclosed under any circumstances."},"goMakeFriends":{"es":"Agrega a tus amigos o comparte la aplicacion con ellos si no conocen sobre esta.","en":"Add your friends o share the application with them if they don\'t know about it."}}')},130:function(e){e.exports=JSON.parse('{"REQUESTED":{"es":"Estado: PEDIDO","en":"State: REQUESTED"},"ASKED":{"es":"Estado: SOLICITADO","en":"State: ASKED"},"DECLINED":{"es":"Estado: RECHAZADO","en":"State: DECLINED"},"BLOCKED":{"es":"Estado: BLOQUEADO","en":"State: BLOCKED"},"DELETED":{"es":"Estado: ELIMINADO","en":"State: DELETED"},"descREQUESTED":{"es":"Estado: Esperando a que acepten su solicitud de amistad","en":"State: Waiting for the acceptance of the friend request"},"descASKED":{"es":"Estado: Este usuario solicita ser su amigo","en":"State: This user wants to be your friend"},"descDECLINED":{"es":"Estado: Su solicitud de amistad ha sido rechazada","en":"State: Your friend request has been declined"},"descBLOCKED":{"es":"Estado: Usted ha sido bloqueado por este contacto","en":"State: You have been bloked by this contact"},"descDELETED":{"es":"Estado: Usted ha sido eliminado por este contacto","en":"State: You have been deleted by this contact"}}')},131:function(e){e.exports=JSON.parse('{"decline":{"es":"Cancelar peticion","en":"Decline request"},"errorDeclining":{"es":"Error al cancelar solicitud de amistad","en":"Error declining friend request"}}')},132:function(e){e.exports=JSON.parse('{"delete":{"es":"Eliminar contacto","en":"Delete contact"},"onDeleteError":{"es":"El contacto no se pudo eliminar","en":"Contact could not be removed"}}')},133:function(e){e.exports=JSON.parse('{"addContact":{"es":"Adicionar","en":"Add"},"addGroup":{"es":"Grupo","en":"Group"},"sendMsg":{"es":"Enviar","en":"Send"},"shareMsg":{"es":"Compartir","en":"Share"},"sendAll":{"es":"Difusi\xf3n","en":"Diffusion"}}')},186:function(e){e.exports=JSON.parse('{"share":{"es":"Compartir","en":"Share"},"shareDesc":{"es":"Envia un correo elect\xf3nico a tus amigos para compartir la aplicaci\xf3n","en":"Send a email to your friends to share."},"report":{"es":"Reportar un error","en":"Report a bug"},"reportDesc":{"es":"Reporta un error y lo corregiremos lo mas pronto posible.","en":"Report a bug and we will correct it as soon as possible."},"feedback":{"es":"Retroalimenzaci\xf3n","en":"Feedback"},"feedbackDesc":{"es":"H\xe1ganos saber que piensa de la aplicaci\xf3n y que podemos hacer para mejorar.","en":"Let us know what you think of the application and what we can do to improve."},"edit":{"es":"Editar perfil","en":"Edit profile"},"editDesc":{"es":"Edita los datos de tu perfil.","en":"Edit your profile data."},"logout":{"es":"Salir","en":"Logout"},"editpass":{"es":"Cambiar contrase\xf1a","en":"Edit password"},"editpassDesc":{"es":"Permite cambiar su contrase\xf1a.","en":"Allow edit your password."}}')},19:function(e){e.exports=JSON.parse('{"hello":{"es":"Hola ","en":"Hello "},"hello1":{"es":", ay\xfadanos a configurar tu perfil","en":", help us to configure your profile"},"descriptionText":{"es":"En esta vista puede realizar algunas de las configuraciones iniciales de la aplicaci\xf3n. Estas no son obligatorias y pueden ser ajustadas o modificadas en cualquier momento.","en":"In this interface, you can make some initial configurations of the application. These are not mandatory and can be adjusted or modified any time."},"labelIdioma":{"es":"Seleccione el idioma","en":"Select language"},"labelSexo":{"es":"G\xe9nero","en":"Gender"},"labelNickname":{"es":"Nombre de pila","en":"Nickname"},"labelAvatar":{"es":"Avatar","en":"Avatar"},"choosefile":{"es":"Seleccione","en":"Choose"},"label1":{"es":"Activando usuario y salvando configuraci\xf3n","en":"Activating user and saving configuration"},"label2":{"es":"Usuario activado","en":"User activated"},"label3":{"es":"Ir a p\xe1gina de entrada","en":"Go to login page"},"content3":{"es":"Felicidades, ha concluido el proceso de registro y activacion de su cuenta. Puede entrar a la aplicai\xf3n usando su correo y la contrase\xf1a. Que la disfrute!","en":"Congratulations, you are done with the signup process. Login on the application using your email and your password. Enjoy it!"},"next":{"es":"Siguiente","en":"Next"},"back":{"es":"Anterior","en":"Back"},"goLogin":{"es":"Continuar","en":"Continue"}}')},190:function(e){e.exports=JSON.parse('{"errorLoadConversation":{"es":"Error al cargar mensajes","en":"Error loading messages"}}')},21:function(e){e.exports=JSON.parse('{"disconnected":{"es":"se ha desconectado","en":"has disconnected"},"connected":{"es":"se ha conectado","en":"has connected"},"accept":{"es":"te ha aceptado","en":"has accepted you"},"decline":{"es":"te ha rechazado","en":"has declined you"},"delete":{"es":"te ha eliminado","en":"has deleted you"},"block":{"es":"te he bloqueado","en":"has bloqued you"},"errorLoadingFriends":{"es":"Error al cargar contactos","en":"Error while loading contacts"},"requestedInv":{"es":"solicita ser su amigo","en":"request be your friend"},"declinedInv":{"es":"ha cancelado la solicitud de amistad","en":"cancel the friend request"},"writingYou":{"es":"ha escrito","en":"has whritten"}}')},212:function(e,t,a){e.exports=a(298)},217:function(e,t,a){},291:function(e,t){},298:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(13),c=a.n(o),i=(a(217),a(4)),l=Object(i.atom)({key:"idiomaState",default:function(){var e="en",t=navigator.language||navigator.userLanguage;return/^(es-).+/.test(t)&&(e="es"),e}()}),s=Object(i.atom)({key:"loginData",default:null}),u=Object(i.atom)({key:"userAvatarState",default:null}),d=Object(i.atom)({key:"chatConversation",default:{active:!1}}),m=Object(i.atom)({key:"contactListState",default:[]}),f=(Object(i.atom)({key:"view",default:"LOGIN"}),Object(i.atom)({key:"backdropState",default:!1}),Object(i.atom)({key:"subscribeToEventsState",default:!1})),p=Object(i.atom)({key:"addContactViewOpenState",default:!1}),g=Object(i.atom)({key:"friendsAtom",default:[]}),b=Object(i.atom)({key:"activeChatWith",default:null}),v=function(e){return Object(i.atom)({key:"conversationWith_".concat(e),default:[]})},E=(Object(i.atom)({key:"messagesAtom",default:null}),Object(i.atom)({key:"tokenTimeoutAtom",default:{tokentimeout:0}})),h=a(18),k=a(376),S=a(378),O=a(101),j=a.n(O),y=a(9),I=a(14),C=a.n(I),w=a(409),x=a(373),R=a(404),N=a(377),A=a(403),D=a(380),T=a(379),F=a(70),q=a.n(F),z=a(38),L=a(374),P=a(375),V=a(71),_=a.n(V),B=a(7),W=Object(i.atom)({key:"notificationAtom",default:{open:!1,autoHideDuration:6e3,severity:"success",msg:""}}),U=function(){var e=Object(i.useRecoilState)(W),t=Object(y.a)(e,2),a=t[0],n=t[1],r=Object(B.a)(Object(B.a)({},a),{},{open:!0,autoHideDuration:3e3}),o=function(e,t){n(Object(B.a)(Object(B.a)({},r),{},{severity:e,msg:t}))};return{openNotification:function(e){n(Object(B.a)(Object(B.a)({},r),e))},openSuccessNotification:function(e){o("success",e)},openErrorNotification:function(e){o("error",e)},openInfoNotification:function(e){o("info",e)},openWarningNotification:function(e){o("warning",e)}}},M=a(45),H=a(406),J=a(364),G=a(365),Y=a(366),K=a(372),$=function(e){var t=e.idioma,a=e.forgetPassHandler,n=e.forgotWinState,o=e.forgotWinOk,c=e.onChangeForgotEmail,i=e.forgotEmailState;return r.a.createElement(H.a,{open:n,onClose:a,"aria-labelledby":"form-dialog-title"},r.a.createElement(J.a,{id:"form-dialog-title"},M.title[t]),r.a.createElement(G.a,null,r.a.createElement(Y.a,null,M.forgotText[t]),r.a.createElement(R.a,{autoFocus:!0,margin:"dense",id:"name",label:M.email[t],type:"email",fullWidth:!0,onChange:c,value:i.value,helperText:i.valid?"":M.invalidEmail[t],error:!i.valid})),r.a.createElement(K.a,null,r.a.createElement(x.a,{onClick:a,color:"primary"},M.forgotBtnCancel[t]),r.a.createElement(x.a,{onClick:o,color:"primary"},M.forgotBtnOk[t])))},Q={server:"https://shut-app-back.herokuapp.com"},Z=function(e){var t=e.idioma,a=e.forgotWinState,o=e.forgetPassHandler,c=Object(n.useState)({value:"",valid:!0}),i=Object(y.a)(c,2),l=i[0],s=i[1],u=U(),d=u.openSuccessNotification,m=u.openErrorNotification;return r.a.createElement($,{idioma:t,forgotWinState:a,onChangeForgotEmail:function(e){var t=e.target.value;s(Object(B.a)(Object(B.a)({},l),{},{valid:!0,value:t}))},forgotWinOk:function(){/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(l.value)?C.a.post("".concat(Q.server,"/users/forgot"),{email:l.value,hostname:window.location.host}).then((function(e){201===e.status&&d(M.emailSended[t]),o()})).catch((function(e){404===e.response.status?m(M.emailNotFound[t]):m(M.error[t])})):s(Object(B.a)(Object(B.a)({},l),{},{valid:!1}))},forgotEmailState:l,setForgotEmailStste:s,forgetPassHandler:o})},X=function(e){return r.a.createElement(Z,e)},ee=a(46),te=Object(L.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)},link:{cursor:"pointer"}}}));function ae(e){var t=e.idioma,a=e.emailRef,n=e.passRef,o=e.onSignIn,c=e.rememberChecked,i=e.onRememberChange,l=e.forgetPassHandler,s=e.forgotWinState,u=te();return r.a.createElement(P.a,{component:"main",maxWidth:"xs"},r.a.createElement(k.a,null),r.a.createElement("div",{className:u.paper},r.a.createElement(w.a,{className:u.avatar},r.a.createElement(q.a,null)),r.a.createElement(z.a,{component:"h1",variant:"h5"},ee.signin[t]),r.a.createElement("form",{className:u.form,noValidate:!0},r.a.createElement(R.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:ee.email[t],name:"email",autoComplete:"email",autoFocus:!0,inputRef:a}),r.a.createElement(R.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:ee.password[t],type:"password",id:"password",autoComplete:"current-password",inputRef:n}),r.a.createElement(N.a,{control:r.a.createElement(A.a,{value:"remember",color:"primary",checked:c,onChange:i}),label:ee.rememberme[t]}),r.a.createElement(x.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:u.submit,onClick:o},ee.signin[t]),r.a.createElement(T.a,{container:!0},r.a.createElement(T.a,{item:!0,xs:!0},r.a.createElement(D.a,{className:u.link,onClick:l},ee.forgotpassword[t])),r.a.createElement(T.a,{item:!0},r.a.createElement(_.a,{to:"/signup"},ee.gosignup[t]))))),r.a.createElement(X,{idioma:t,forgotWinState:s,forgetPassHandler:l}))}var ne,re=a(58),oe=a.n(re),ce=a(97),ie=function(){var e=Object(ce.a)(oe.a.mark((function e(t){var a,n,r;return oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=localStorage.getItem("token"),n=localStorage.getItem("token_expires"),!(a&&n&&new Date(n).getTime()>(new Date).getTime())){e.next=7;break}return e.next=5,t(a);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=ie,se=function(e){var t=Object(i.useRecoilState)(l),a=Object(y.a)(t,2),o=a[0],c=a[1],d=Object(i.useSetRecoilState)(u),m=Object(i.useSetRecoilState)(E),f=Object(i.useSetRecoilState)(s),p=Object(n.useState)(null),g=Object(y.a)(p,2),b=g[0],v=g[1],k=U().openErrorNotification,S=Object(n.useRef)(""),O=Object(n.useRef)(""),j=Object(n.useState)(!1),I=Object(y.a)(j,2),w=I[0],x=I[1],R=Object(n.useState)(!1),N=Object(y.a)(R,2),A=N[0],D=N[1];Object(n.useEffect)((function(){le((function(e){C.a.post("".concat(Q.server,"/users/loginWithToken"),{token:e}).then((function(e){if(200===e.status){var t=e.data,a=t.token,n=t.token_expires,r=t._id,o=t.nickname,i=t.firstName,l=t.lastname,s=t.email,u=t.gender,p=t.language,g=t.avatarUrl;localStorage.setItem("token",a),localStorage.setItem("token_expires",n),m({timeleft:n}),f({userId:r,nickname:o,firstName:i,lastName:l,email:s,gender:u}),c(p),d("".concat(Q.server).concat(g)),v(!0)}})).catch((function(e){console.log("Error al cargar los datos del usuario usando el token")}))})),localStorage.email&&localStorage.password&&localStorage.rememberme&&(S.current.value=localStorage.email,O.current.value=localStorage.password,x(!0))}),[]);return b?r.a.createElement(h.Redirect,{to:"/contacts"}):r.a.createElement(ae,{idioma:o,emailRef:S,passRef:O,rememberChecked:w,onRememberChange:function(e){return x(e.target.checked)},onSignIn:function(e){e.preventDefault(),!0===w?(localStorage.setItem("email",S.current.value),localStorage.setItem("password",O.current.value),localStorage.setItem("rememberme",!0)):(localStorage.removeItem("email"),localStorage.removeItem("password"),localStorage.removeItem("rememberme")),C.a.post("".concat(Q.server,"/users/login"),{email:S.current.value,password:O.current.value}).then((function(e){if(200===e.status){var t=e.data,a=t.token,n=t.token_expires,r=t._id,o=t.nickname,i=t.firstName,l=t.lastname,s=t.email,u=t.gender,p=t.language,g=t.avatarUrl,b=t.refresh_token,E=t.refresh_token_expires;localStorage.setItem("token",a),localStorage.setItem("refresh_token",b),localStorage.setItem("token_expires",n),localStorage.setItem("refresh_token_expires",E),m({timeleft:n}),f({userId:r,nickname:o,firstName:i,lastName:l,email:s,gender:u}),c(p),d("".concat(Q.server).concat(g)),v(!0)}})).catch((function(e){403===e.response.status?k(ee.notAuthorized[o]):k(ee.internalError[o])}))},forgotWinState:A,forgetPassHandler:function(){D(!A)}})},ue=function(e){return r.a.createElement(se,null)},de=a(108),me=a(76),fe=Object(i.selector)({key:"friendSelector",get:function(e){var t=e.get;return t(g).length>0?Object(me.a)(t(g)).sort((function(e,t){if(1===e.friendShipStatus&&1===t.friendShipStatus){if(e.socketId&&!t.socketId)return-1;if(!e.socketId&&t.socketId)return 1}return e.friendShipStatus<t.friendShipStatus?-1:e.friendShipStatus>t.friendShipStatus?1:e.email<t.email?-1:e.email>t.email?1:void 0})):[]},set:function(){var e=Object(ce.a)(oe.a.mark((function e(t,a){var n,r,o,c,i,s,u,d,m,f,p;return oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.set,r=t.get,o=a.action,c=a.payload,e.t0=o,e.next="initialize"===e.t0?5:"add"===e.t0?7:"update"===e.t0?9:"reset_cant_no_leidos"===e.t0?11:"set_message_info"===e.t0?13:"delete"===e.t0?15:"connect"===e.t0?17:"disconnect"===e.t0?19:24;break;case 5:return n(g,(function(e){return 0===e.length?c.friends:e})),e.abrupt("break",25);case 7:return n(g,(function(e){var t=Object(me.a)(e);return t.push(c.friend),t})),e.abrupt("break",25);case 9:return n(g,(function(e){var t=e.findIndex((function(e){return e.contactId===c.friend.contactId}));return e.slice(0,t).concat([c.friend]).concat(e.slice(t+1))})),e.abrupt("break",25);case 11:return n(g,(function(e){var t=e.findIndex((function(e){return e.contactId===c.contactId}));return e.slice(0,t).concat([Object(B.a)(Object(B.a)({},e[t]),{},{unread:0})]).concat(e.slice(t+1))})),e.abrupt("break",25);case 13:return n(g,(function(e){var t=c.dataObj;return e.map((function(e){if(t[e.contactId]){var a=0;return e.unread&&(a=e.unread),t[e.contactId].cantidad&&(a+=t[e.contactId].cantidad),Object(B.a)(Object(B.a)({},e),{},{unread:a,lastMsg:t[e.contactId].lastMessage,datetime:t[e.contactId].datetime})}return e}))})),e.abrupt("break",25);case 15:return n(g,(function(e){return e.filter((function(e){return e.contactId!==c.friendId}))})),e.abrupt("break",25);case 17:return Array.isArray(c.data)?(console.log(c.data),n(g,(function(e){return console.log(e),e.map((function(e){var t=c.data.findIndex((function(t){return t.userId===e.contactId}));return t>=0?Object(B.a)(Object(B.a)({},e),{},{socketId:c.data[t].socketId}):Object(B.a)({},e)}))}))):(i=c.data,s=i.userId,u=i.socketId,d=null,m=0,n(g,(function(e){var t=e.findIndex((function(e){return e.contactId===s}));if(t>=0){d=e[t].nickname,m=e[t].friendShipStatus;var a=Object(B.a)(Object(B.a)({},e[t]),{},{socketId:u});return e.slice(0,t).concat([a]).concat(e.slice(t+1))}return e})),d&&1===m&&c.notification("".concat(d," ").concat(c.msg[r(l)]),{variant:"info"})),e.abrupt("break",25);case 19:return f=null,p=0,n(g,(function(e){var t=e.findIndex((function(e){return e.socketId===c.socketId}));return t>=0?(f=e[t].nickname,p=e[t].friendShipStatus,Object(me.a)(e).slice(0,t).concat([Object(B.a)(Object(B.a)({},e[t]),{},{socketId:null})]).concat(e.slice(t+1))):e})),f&&1===p&&c.notification("".concat(f," ").concat(c.msg[r(l)]),{variant:"warning"}),e.abrupt("break",25);case 24:return e.abrupt("break",25);case 25:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()}),pe=Object(i.selector)({key:"conversationSelector",set:function(e,t){var a=e.set,n=t.contactId,r=t.conversation,o=function(e,t,a,n){return e===a?0:t===a?n?3:2:void 0};a(v(n),(function(e){return r.map((function(e){return{_id:e._id,content:e.content,datetime:e.datetime,state:o(e.userOrigin,e.userDestiny,n,e.readed)}}))}))}}),ge=Object(i.selector)({key:"addMessageToConversation",set:function(e,t){var a=e.set,n=t.contactId,r={_id:t.messageId,content:t.content,datetime:t.datetime,state:t.state};a(v(n),(function(e){return e.concat([r])}))}}),be=Object(i.selector)({key:"editMsgToStateSavedSelector",set:function(e,t){var a=e.set,n=t.contactId,r=t.messageId,o=t.datetime,c=t.consecutive;a(v(n),(function(e){var t=e.findIndex((function(e){return e._id===c&&1===e.state}));if(t>=0){var a=Object(B.a)(Object(B.a)({},e[t]),{},{state:2,_id:r,datetime:o});return e.slice(0,t).concat([a]).concat(e.slice(t+1))}return e}))}}),ve=Object(i.selector)({key:"editAllMsgToSavedSelector",set:function(e,t){var a=e.set,n=t.contactId;a(v(n),(function(e){return e.map((function(e){return 0!==e.state?Object(B.a)(Object(B.a)({},e),{},{state:3}):e}))}))}}),Ee=function(){var e=U(),t=e.openErrorNotification,a=e.openSuccessNotification;return{postRequest:function(e){var n=e.url,r=e.bodyParams,o=void 0===r?{}:r,c=e.doFnAfterSuccess,i=void 0===c?null:c,l=e.doFnAfterError,s=void 0===l?null:l,u=e.messageOnSuccess,d=void 0===u?null:u,m=e.messageOnError,f=void 0===m?null:m;le((function(e){C.a.post("".concat(Q.server).concat(n),o,{headers:{Authorization:e}}).then((function(t){d&&a(d),i&&i(t,e)})).catch((function(e){f&&t(f),s&&s(e)}))}))}}},he=a(371),ke=a(387),Se=a(384),Oe=a(193),je=a(305),ye=a(300),Ie=a(385),Ce=a(383),we=a(386),xe=a(107),Re=a(105),Ne=a(5),Ae=a(100),De=a.n(Ae),Te=a(177),Fe=a.n(Te),qe=a(130),ze=a(381),Le=a(382),Pe=a(171),Ve=a.n(Pe),_e=a(98),Be=function(e){var t=e.idioma,a=e.onClick;return r.a.createElement(ze.a,{onClick:a},r.a.createElement(Le.a,null,r.a.createElement(Ve.a,{fontSize:"small",color:"primary"})),r.a.createElement(Ce.a,{primary:_e.acceptInv[t]}))},We=a(172),Ue=a.n(We),Me={getSocket:function(){return ne||(ne=Ue()(Q.server))},close:function(){ne.close()}},He=function(e){var t=e.preAction,a=e.contact,n=Object(i.useRecoilValue)(l),o=Object(i.useRecoilValue)(s),c=U().openErrorNotification,u=Object(i.useSetRecoilState)(fe);return r.a.createElement(Be,{idioma:n,onClick:function(){t();le((function(e){C.a.post("".concat(Q.server,"/users/acceptFriendRequest"),{acceptedUserId:a.contactId},{headers:{Authorization:e}}).then((function(t){200===t.status&&(u({action:"update",payload:{friend:Object(B.a)(Object(B.a)({},t.data.friend),{},{socketId:a.socketId})}}),Me.getSocket().emit("accept friendship",{accepterId:o.userId,socketIdRequester:a.socketId,token:e}))})).catch((function(e){c(_e.errorAccepting[n])}))}))}})},Je=function(e){return r.a.createElement(He,e)},Ge=a(131),Ye=a(173),Ke=a.n(Ye),$e=function(e){var t=e.idioma,a=e.text,n=e.onClick;return r.a.createElement(ze.a,{onClick:n},r.a.createElement(Le.a,null,r.a.createElement(Ke.a,{fontSize:"small",color:"error"})),r.a.createElement(Ce.a,{primary:a.decline[t]}))},Qe=function(e){var t=e.preAction,a=e.contact,n=Object(i.useRecoilValue)(l),o=U().openErrorNotification,c=Object(i.useSetRecoilState)(fe),u=Object(i.useRecoilValue)(s);return r.a.createElement($e,{idioma:n,onClick:function(){t();le((function(e){C.a.post("".concat(Q.server,"/users/declineFriendRequest"),{declinedUserId:a.contactId},{headers:{Authorization:e}}).then((function(e){200===e.status&&c({action:"delete",payload:{friendId:a.contactId}})})).then((function(){Me.getSocket().emit("decline friendship",{declinerId:u.userId,declinedId:a.contactId,socketIdDeclined:a.socketId,token:e})})).catch((function(e){o(Ge.errorDeclining[n])}))}))},text:Ge})},Ze=function(e){return r.a.createElement(Qe,e)},Xe=a(174),et=a.n(Xe),tt=function(e){var t=e.idioma,a=e.onClick,n=e.text;return r.a.createElement(ze.a,{onClick:a},r.a.createElement(Le.a,null,r.a.createElement(et.a,{fontSize:"small",color:"error"})),r.a.createElement(Ce.a,{primary:n.delete[t]}))},at=a(132),nt=function(e){var t=e.preAction,a=e.contact,n=Object(i.useRecoilValue)(l),o=Object(i.useRecoilValue)(s),c=Ee().postRequest,u=Object(i.useSetRecoilState)(fe);return r.a.createElement(tt,{idioma:n,text:at,onClick:function(){t(),c({url:"/users/deleteContact",bodyParams:{deletedUserId:a.contactId},messageOnError:at.onDeleteError[n],doFnAfterSuccess:function(e,t){200===e.status&&(u({action:"delete",payload:{friendId:a.contactId}}),1===a.friendShipStatus&&Me.getSocket().emit("delete contact",{deleterId:o.userId,socketIdDeleted:a.socketId,token:t}))}})}})},rt=function(e){return r.a.createElement(nt,e)},ot=a(175),ct=a.n(ot),it=a(99),lt=function(e){var t=e.idioma,a=e.onClick;return r.a.createElement(ze.a,{onClick:a},r.a.createElement(Le.a,null,r.a.createElement(ct.a,{fontSize:"small",color:"error"})),r.a.createElement(Ce.a,{primary:it.block[t]}))},st=function(e){var t=e.preAction,a=e.contact,n=Object(i.useRecoilValue)(l),o=Object(i.useRecoilValue)(s),c=Ee().postRequest,u=Object(i.useSetRecoilState)(fe);return r.a.createElement(lt,{idioma:n,onClick:function(){t(),c({url:"/users/blockUser",bodyParams:{blokedUserId:a.contactId},messageOnError:it.onBlockError[n],doFnAfterSuccess:function(e,t){200===e.status&&(u({action:"delete",payload:{friendId:a.contactId}}),Me.getSocket().emit("block contact",{blokerId:o.userId,socketIdBloked:a.socketId,token:t}))}})}})},ut=function(e){return r.a.createElement(st,e)},dt=function(e){var t=e.handleClose,a=e.contact,n=function(){t()};switch(a.friendShipStatus){case 1:return r.a.createElement(r.a.Fragment,null,r.a.createElement(rt,{preAction:n,contact:a}),r.a.createElement(ut,{preAction:n,contact:a}));case 2:return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ze,{preAction:n,contact:a}),r.a.createElement(ut,{preAction:n,contact:a}));case 3:return r.a.createElement(r.a.Fragment,null,r.a.createElement(Je,{preAction:n,contact:a}),r.a.createElement(Ze,{preAction:n,contact:a}),r.a.createElement(ut,{preAction:n,contact:a}));case 4:return r.a.createElement(r.a.Fragment,null,r.a.createElement(rt,{preAction:n,contact:a}),r.a.createElement(ut,{preAction:n,contact:a}));case 5:case 6:return r.a.createElement(rt,{preAction:n,contact:a});default:return null}},mt=Object(L.a)((function(e){return{infoIcon:{marginRight:"-12px",overflow:"visible",textAlign:"center",flex:"0 0 auto",color:"rgba(0, 0, 0, 0.54)",padding:"12px",fontSize:"1.5rem",transition:"background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms",borderRadius:"50%",border:0,cursor:"pointer",margin:0,display:"inline-flex",outline:0,position:"relative",alignItems:"center",userSelect:"none",verticalAlign:"middle",justifyContent:"center",textDecoration:"none"},listItemText:{paddingRight:e.spacing(10)}}})),ft=Object(Ne.a)((function(e){return{badge:{backgroundColor:"#44b700",color:"#44b700",boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(Se.a),pt=Object(Ne.a)((function(e){return{badge:{backgroundColor:e.palette.grey[500],color:e.palette.grey[500],boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(Se.a),gt=function(e){return e.contact.socketId&&1===e.contact.friendShipStatus?r.a.createElement(ft,{overlap:"circle",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot"},e.children):r.a.createElement(pt,{overlap:"circle",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot"},e.children)},bt=Object(Ne.a)({paper:{border:"1px solid #d3d4d5"}})((function(e){return r.a.createElement(Oe.a,Object.assign({elevation:0,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},e))})),vt=Object(L.a)((function(e){return{arrow:{color:xe.a[500]},tooltip:{backgroundColor:xe.a[500]}}})),Et=Object(L.a)((function(e){return{arrow:{color:Re.a[500]},tooltip:{backgroundColor:Re.a[500]}}})),ht=function(e){var t=Et(),a=vt();return r.a.createElement(je.a,Object.assign({arrow:!0,classes:"red"===e.color?t:a},e))},kt=r.a.memo((function(e){var t=e.idioma,a=e.contact,n=e.handleMenu,o=e.handleClose,c=e.anchorEl,i=e.openChat,l=a.lastMsg?a.lastMsg:"",s=mt(),u="checkbox-list-secondary-label-".concat(a.email);return r.a.createElement(r.a.Fragment,{key:a.email},r.a.createElement(ye.a,{button:!0,onClick:i},r.a.createElement(Ie.a,null,r.a.createElement(gt,{contact:a},a.unread&&a.unread>0?r.a.createElement(Se.a,{color:"secondary",badgeContent:a.unread},r.a.createElement(w.a,{alt:"Avatar n\xb0".concat(a.nickname),src:"".concat(Q.server).concat(a.avatarUrl)})):r.a.createElement(w.a,{alt:"Avatar n\xb0".concat(a.nickname),src:"".concat(Q.server).concat(a.avatarUrl)}))),r.a.createElement(Ce.a,{id:u,primary:a.nickname,secondary:a.friendShipStatus>1?qe[a.friendShipStatusCode][t]:"".concat(l.slice(0,55),"..."),secondaryTypographyProps:a.friendShipStatus>3?{style:{color:"".concat(Re.a[500])}}:a.friendShipStatus<4&&a.friendShipStatus>1?{style:{color:"".concat(xe.a[500])}}:{},className:s.listItemText}),r.a.createElement(we.a,null,a.friendShipStatus>1?r.a.createElement(ht,{title:qe["desc".concat(a.friendShipStatusCode)][t],color:a.friendShipStatus>3?"red":"geen"},r.a.createElement("div",{className:s.infoIcon},r.a.createElement(Fe.a,{fontSize:"small",style:{color:a.friendShipStatus>3?Re.a[500]:xe.a[500]}}))):null,r.a.createElement(S.a,{edge:"end","aria-label":"delete",onClick:n},r.a.createElement(De.a,{fontSize:"default"})),r.a.createElement(bt,{id:"customized-menu",anchorEl:c,keepMounted:!0,open:Boolean(c),onClose:o},r.a.createElement(dt,{handleClose:o,contact:a})))),r.a.createElement(ke.a,{variant:"inset",component:"li"}))})),St=function(e){var t=e.contact,a=Object(n.useState)(null),o=Object(y.a)(a,2),c=o[0],u=o[1],d=Object(i.useRecoilValue)(l),m=Object(i.useRecoilValue)(s),f=Object(i.useSetRecoilState)(b),p=Object(i.useSetRecoilState)(fe),g=Object(n.useCallback)((function(){u(null)}),[]);return r.a.createElement(kt,{handleMenu:function(e){u(e.currentTarget)},handleClose:g,contact:t,anchorEl:c,idioma:d,openChat:function(){f(t.contactId),p({action:"reset_cant_no_leidos",payload:{contactId:t.contactId}}),Me.getSocket().emit("read messages",{userId:m.userId,contactId:t.contactId,notifyTo:t.socketId,token:localStorage.getItem("token")})}})},Ot=function(e){return r.a.createElement(St,e)},jt=function(e){var t=e.idioma,a=e.text,n=e.contacts;return r.a.createElement(he.a,null,n.length>0?n.map((function(e){return r.a.createElement(Ot,{contact:e})})):r.a.createElement(r.a.Fragment,null,r.a.createElement(ke.a,null),r.a.createElement(z.a,{variant:"h5",align:"justify"},a.goMakeFriends[t]),r.a.createElement(ke.a,null),r.a.createElement(z.a,{variant:"subtitle1",align:"justify"},a.beta[t])))},yt=function(e){var t=Object(i.useSetRecoilState)(f),a=Ee().postRequest,o=Object(i.useRecoilState)(fe),c=Object(y.a)(o,2),s=c[0],u=c[1],d=Object(i.useRecoilValue)(l),m=function(){console.log("search friendssss"),0===s.length?(console.log("manda a buscar los friends"),a({url:"/users/searchFirends",messageOnError:de.errorLoadingFriends[d],doFnAfterSuccess:function(e){200===e.status&&(u({action:"initialize",payload:{friends:e.data.friends}}),t(!0),e.data.friends.length>0&&a({url:"/users/getContactData",messageOnError:de.errorLoadingFriendsData[d],doFnAfterSuccess:function(e){200===e.status&&u({action:"set_message_info",payload:{dataObj:e.data.contactsData}})}}))}})):console.log("NO LOS MANDA A BUSCAR")};return Object(n.useEffect)((function(){m()}),[]),r.a.createElement(jt,{idioma:d,contacts:s,text:de})},It=function(e){return r.a.createElement(yt,null)},Ct=a(410),wt=a(411),xt=a(388),Rt=a(178),Nt=a.n(Rt),At=a(179),Dt=a.n(At),Tt=a(133),Ft=Object(L.a)((function(e){return{speedDial:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2)}}})),qt=function(e){var t=e.idioma,a=e.handleOpen,n=e.handleClose,o=e.open,c=e.openAddContactView,i=Ft();return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ct.a,{ariaLabel:"SpeedDial tooltip example",className:i.speedDial,icon:r.a.createElement(wt.a,null),onClose:n,onOpen:a,open:o},r.a.createElement(xt.a,{key:"add",icon:r.a.createElement(Nt.a,{color:"error"}),tooltipTitle:Tt.addContact[t],tooltipOpen:!0,onClick:c}),r.a.createElement(xt.a,{key:"addgroup",icon:r.a.createElement(Dt.a,{color:"error"}),tooltipTitle:Tt.sendAll[t],tooltipOpen:!0,onClick:function(){console.log("Enviar mensaje de difusion"),alert("Not implemented!")}})))},zt=a(15),Lt=a(196),Pt=a(134),Vt=a.n(Pt),_t=a(106),Bt=a(103),Wt=a(389),Ut=a(180),Mt=a.n(Ut),Ht=a(60),Jt=Object(L.a)((function(e){return{avatar:{backgroundColor:_t.a[100],color:_t.a[600]},dialogContent:{padding:0},search:{position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(zt.c)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(zt.c)(e.palette.common.white,.25)},marginLeft:0,width:"100%"},searchIcon:{padding:e.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:{padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),"px)"),transition:e.transitions.create("width"),width:"100%"}}})),Gt=function(e){var t=e.user,a=e.sendFriendRequest,n=Jt();return r.a.createElement(ye.a,{key:t.email},r.a.createElement(Ie.a,null,r.a.createElement(w.a,{className:n.avatar,src:Q.server+t.avatarUrl})),r.a.createElement(Ce.a,{primary:t.nickname,secondary:t.email}),r.a.createElement(we.a,null,r.a.createElement(S.a,{color:t.blockinguser?Bt.a[100]:_t.a[300],onClick:function(){a(t.userId)},disabled:t.blockinguser},r.a.createElement(Mt.a,{color:t.blockinguser?"disabled":"primary"}))))},Yt=function(e){var t=e.idioma,a=e.buscarUsuarios,n=e.inputSearchRef,o=Jt(),c=r.a.useState(""),i=Object(y.a)(c,2),l=i[0],s=i[1];return r.a.createElement("div",{className:o.search},r.a.createElement("div",{className:o.searchIcon},r.a.createElement(Vt.a,null)),r.a.createElement(Lt.a,{onKeyPress:function(e){13===e.charCode&&a()},placeholder:Ht.search[t],classes:{root:o.inputRoot,input:o.inputInput},inputProps:{"aria-label":"search"},value:l,onChange:function(e){var t=e.target.value;s(t)},inputRef:n,endAdornment:r.a.createElement(Wt.a,{position:"end"},""!==l?r.a.createElement(S.a,{size:"small","aria-label":"toggle password visibility",onClick:function(){s("")}},r.a.createElement(j.a,null)):null,r.a.createElement(S.a,{size:"small","aria-label":"toggle password visibility",onClick:a},r.a.createElement(Vt.a,null)))}))},Kt=function(e){var t=e.idioma,a=e.closeAddContactWin,n=e.open,o=e.buscarUsuarios,c=e.users,i=e.inputSearchRef,l=e.sendFriendRequest,s=Jt();return r.a.createElement(H.a,{maxWidth:"xs",onEntering:function(){},"aria-labelledby":"confirmation-dialog-title",open:n,onClose:a},r.a.createElement(J.a,{id:"confirmation-dialog-title",className:s.dialogTitle},Ht.title[t]," "),r.a.createElement(ke.a,null),r.a.createElement(Yt,{idioma:t,buscarUsuarios:o,inputSearchRef:i}),r.a.createElement(G.a,{dividers:!0,className:s.dialogContent},r.a.createElement(he.a,{style:{minHeight:"200px"}},c.map((function(e){return r.a.createElement(Gt,{user:e,sendFriendRequest:l})})))),r.a.createElement(K.a,null,r.a.createElement(x.a,{autoFocus:!0,onClick:a,color:"primary"},Ht.close[t])))},$t=function(e){var t=Object(i.useRecoilValue)(l),a=Object(i.useRecoilState)(p),o=Object(y.a)(a,2),c=o[0],u=o[1],d=Object(n.useState)([]),m=Object(y.a)(d,2),f=m[0],g=m[1],b=U().openErrorNotification,v=Object(n.useRef)({value:""}),E=Object(i.useRecoilValue)(s),h=Object(i.useSetRecoilState)(fe),k=function(){le((function(e){C.a.post("".concat(Q.server,"/users/searchContact"),{stringPattern:v.current.value,start:0,limit:20},{headers:{Authorization:e}}).then((function(e){200===e.status&&g(e.data.users)})).catch((function(e){b(Ht.lbErrorLoadingUsers[t])}))}))};Object(n.useEffect)((function(){k()}),[]);return r.a.createElement(Kt,{idioma:t,closeAddContactWin:function(){u(!1)},open:c,users:f,buscarUsuarios:k,inputSearchRef:v,sendFriendRequest:function(e){le((function(a){C.a.post("".concat(Q.server,"/users/sendFriendRequest"),{userId:e},{headers:{Authorization:a}}).then((function(t){200===t.status&&(g((function(t){return t.filter((function(t){return t.userId!==e}))})),h({action:"add",payload:{friend:t.data.friend}}))})).then((function(){Me.getSocket().emit("request friendship",{userIdRequester:E.userId,userIdRequested:e,token:a})})).catch((function(e){b(Ht.lbErrorSendigFriendRequest[t])}))}))}})},Qt=function(e){return r.a.createElement($t,null)},Zt=function(e){var t=Object(n.useState)(!1),a=Object(y.a)(t,2),o=a[0],c=a[1],s=Object(i.useRecoilState)(p),u=Object(y.a)(s,2),d=u[0],m=u[1],f=Object(i.useRecoilValue)(l);return r.a.createElement(r.a.Fragment,null,r.a.createElement(qt,{open:o,handleOpen:function(){c(!0)},handleClose:function(){c(!1)},idioma:f,openAddContactView:function(){m(!0)}}),d?r.a.createElement(Qt,null):null)},Xt=function(e){return r.a.createElement(Zt,null)},ea=Object(L.a)((function(e){return{container:{padding:0,position:"relative",height:"100vh",overflowY:"hidden"}}})),ta=function(e){var t=ea();return r.a.createElement(P.a,{maxWidth:"sm",className:t.container,component:"main"},r.a.createElement(k.a,null),e.children)},aa=function(e){return r.a.createElement(ta,e)},na=a(392),ra=a(393),oa=a(187),ca=a.n(oa),ia=a(370),la=a(390),sa=a(391),ua=a(181),da=a.n(ua),ma=a(185),fa=a.n(ma),pa=a(127),ga=a.n(pa),ba=a(184),va=a.n(ba),Ea=a(182),ha=a.n(Ea),ka=a(183),Sa=a.n(ka),Oa=Object(L.a)((function(e){return{root:{maxWidth:345},avatar:{width:e.spacing(7),height:e.spacing(7)},cardHeaderAction:{alignSelf:"flex-end"}}})),ja=function(){return r.a.createElement(S.a,{size:"small",style:{backgroundColor:"white",boxShadow:"0 0 5px grey"},onClick:function(){return alert("Cambiar foto de perfil")}},r.a.createElement(fa.a,{fontSize:"small"}))},ya=function(e){var t=e.text,a=e.idioma,n=e.avatarUrl,o=e.userData,c=e.logout;console.log(n);var i=Oa();return r.a.createElement(la.a,{className:i.root},r.a.createElement(sa.a,{classes:{action:i.cardHeaderAction},avatar:r.a.createElement(Se.a,{overlap:"circle",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:r.a.createElement(ja,null)},r.a.createElement(w.a,{"aria-label":"recipe",className:i.avatar,src:n})),action:r.a.createElement(x.a,{variant:"outlined",onClick:c},t.logout[a]),title:o.nickname,subheader:o.email}),r.a.createElement(ke.a,null),r.a.createElement(he.a,null,r.a.createElement(ye.a,{button:!0,onClick:function(){return alert("Not implemented")}},r.a.createElement(Le.a,null,r.a.createElement(da.a,null)),r.a.createElement(Ce.a,{primary:t.edit[a],primaryTypographyProps:{style:{fontSize:"0.9em"}}})),r.a.createElement(ye.a,{button:!0,onClick:function(){return alert("Not implemented")}},r.a.createElement(Le.a,null,r.a.createElement(ha.a,null)),r.a.createElement(Ce.a,{primary:t.editpass[a],primaryTypographyProps:{style:{fontSize:"0.9em"}}})),r.a.createElement(ke.a,null),r.a.createElement(ye.a,{button:!0,onClick:function(){return alert("Not implemented")}},r.a.createElement(Le.a,null,r.a.createElement(ga.a,null)),r.a.createElement(Ce.a,{primary:t.share[a],primaryTypographyProps:{style:{fontSize:"0.9em"}},secondary:t.shareDesc[a],secondaryTypographyProps:{style:{fontSize:"0.8em"}}})),r.a.createElement(ye.a,{button:!0,onClick:function(){return alert("Not implemented")}},r.a.createElement(Le.a,null,r.a.createElement(Sa.a,null)),r.a.createElement(Ce.a,{primary:t.feedback[a],primaryTypographyProps:{style:{fontSize:"0.9em"}},secondary:t.feedbackDesc[a],secondaryTypographyProps:{style:{fontSize:"0.8em"}}})),r.a.createElement(ye.a,{button:!0,onClick:function(){return alert("Not implemented")}},r.a.createElement(Le.a,null,r.a.createElement(va.a,null)),r.a.createElement(Ce.a,{primary:t.report[a],primaryTypographyProps:{style:{fontSize:"0.9em"}},secondary:t.reportDesc[a],secondaryTypographyProps:{style:{fontSize:"0.8em"}}}))))},Ia=function(){var e=Object(i.useSetRecoilState)(s),t=Object(i.useSetRecoilState)(u),a=Object(i.useSetRecoilState)(f),r=Object(i.useSetRecoilState)(m),o=Object(i.useSetRecoilState)(g),c=Me.getSocket();return Object(n.useCallback)((function(){t(null),r([]),o([]),c.emit("logout",{}),localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("refresh_token_expires"),localStorage.removeItem("token_expires"),a(!1),e(null)}))},Ca=a(186),wa=function(e){var t=Object(i.useRecoilValue)(l),a=Object(i.useRecoilValue)(s),n=Object(i.useRecoilValue)(u),o=Ia();return r.a.createElement(ya,{text:Ca,idioma:t,avatarUrl:n,userData:a,logout:o})},xa=function(e){return r.a.createElement(wa,null)},Ra=Object(L.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}})),Na=function(e){var t=e.avatarSrc,a=e.userData,n=Ra(),o=r.a.useState(null),c=Object(y.a)(o,2),i=c[0],l=c[1],s=Boolean(i);return r.a.createElement("div",{className:n.root},r.a.createElement(na.a,{position:"static"},r.a.createElement(ra.a,null,r.a.createElement(S.a,{edge:"start",className:n.menuButton,color:"inherit","aria-label":"menu"},r.a.createElement(ca.a,null)),r.a.createElement(z.a,{variant:"h6",className:n.title},"Shutapp"),r.a.createElement("div",null,r.a.createElement(S.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){l(e.currentTarget)},color:"inherit"},r.a.createElement(w.a,{alt:a.nickname,src:t},a.nickname.toUpperCase().split("")[0])),r.a.createElement(ia.a,{open:s,anchorEl:i,onClose:function(){l(null)},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},r.a.createElement(xa,null))))))},Aa=function(e){var t=Object(i.useRecoilValue)(u),a=Object(i.useRecoilValue)(s);return r.a.createElement(Na,{avatarSrc:t,userData:a})},Da=function(e){return r.a.createElement(Aa,null)},Ta=a(52),Fa=a(188),qa=a.n(Fa),za=Object(L.a)((function(e){var t;return{grow:{flexGrow:1},menuButton:{marginRight:e.spacing(.5)},title:{display:"block",marginLeft:e.spacing(1)},customAppBar:(t={width:"100%"},Object(Ta.a)(t,e.breakpoints.up("sm"),{width:e.breakpoints.values.sm}),Object(Ta.a)(t,"right","auto"),t)}})),La=Object(Ne.a)((function(e){return{badge:{backgroundColor:"#44b700",color:"#44b700",boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(Se.a),Pa=Object(Ne.a)((function(e){return{badge:{backgroundColor:e.palette.grey[500],color:e.palette.grey[500],boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(Se.a),Va=function(e){return e.contact.socketId&&1===e.contact.friendShipStatus?r.a.createElement(La,{overlap:"circle",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot"},e.children):r.a.createElement(Pa,{overlap:"circle",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot"},e.children)},_a=function(e){var t=e.closeChat,a=e.contact,n=za();return r.a.createElement(na.a,{position:"fixed",className:n.customAppBar},r.a.createElement(ra.a,null,r.a.createElement(S.a,{edge:"start",className:n.menuButton,color:"inherit","aria-label":"open drawer",onClick:t},r.a.createElement(qa.a,null)),r.a.createElement(Va,{contact:a},r.a.createElement(w.a,{alt:a.nickname,src:Q.server+a.avatarUrl})),r.a.createElement(z.a,{className:n.title,variant:"h5",noWrap:!0},a.nickname),r.a.createElement("div",{className:n.grow}),r.a.createElement(S.a,{"aria-label":"show 4 new mails",color:"inherit"},r.a.createElement(De.a,null))))},Ba=function(){var e=Object(i.useRecoilState)(b),t=Object(y.a)(e,2),a=t[0],n=t[1],o=Object(i.useRecoilValue)(fe).find((function(e){return e.contactId===a}));return r.a.createElement(_a,{closeChat:function(){n(null)},contact:o})},Wa=function(e){return r.a.createElement(Ba,null)},Ua=a(394),Ma=a(189),Ha=a.n(Ma),Ja=a(135),Ga=a.n(Ja),Ya=a(399),Ka=a(401),$a=Object(L.a)((function(e){return{message:{padding:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px"),maxWidth:"60%",marginTop:e.spacing(2),marginBottom:0,marginLeft:"".concat(e.spacing(2),"px"),marginRight:"".concat(e.spacing(2),"px"),borderRadius:"10px",backgroundColor:e.palette.info.light,color:e.palette.info.contrastText,position:"relative"},timeMessage:Object(B.a)({paddingLeft:e.spacing(2),maxWidth:"60%",marginBottom:e.spacing(1),marginLeft:"".concat(e.spacing(2),"px"),marginRight:"".concat(e.spacing(1),"px"),color:e.palette.text.disabled},e.typography.subtitle2),mymsg:{textAlign:"right",alignSelf:"flex-end",borderRadius:"10px 0 10px 10px"},notmymsg:{alignSelf:"flex-start",borderRadius:"0 10px 10px 10px"},msgAvatar:{width:e.spacing(3),height:e.spacing(3),position:"absolute",top:"-".concat(e.spacing(1.5),"px")},myMsgAvatar:{right:"-".concat(e.spacing(1.5),"px")},notMyMsgAvatar:{left:"-".concat(e.spacing(1.5),"px")},doneIcon:{marginRight:e.spacing(1),fontSize:e.spacing(2.2)}}})),Qa=r.a.memo((function(e){var t=e.state,a=e.content,n=e.datetime,o=e.contact,c=e.avatarSrc,i=e.idioma,l=$a(),s=t>0?l.mymsg:l.notmymsg,u=t>0?l.myMsgAvatar:l.notMyMsgAvatar,d=t>0?c:Q.server+o.avatarUrl,m="es"===i?{locale:Ka.a}:{},f=Object(Ya.a)(new Date(n),new Date,m),p=null;return 1===t&&(p=r.a.createElement(Ha.a,{className:l.doneIcon,style:{color:Bt.a[500]}})),2===t&&(p=r.a.createElement(Ga.a,{className:l.doneIcon,style:{color:Bt.a[500]}})),3===t&&(p=r.a.createElement(Ga.a,{className:l.doneIcon,style:{color:Ua.a[500]}})),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"".concat(l.message," ").concat(s)},r.a.createElement(w.a,{alt:o.nickname,src:d,variant:"circle",className:"".concat(l.msgAvatar," ").concat(u)}),a),r.a.createElement("span",{className:" ".concat(s)},r.a.createElement("span",{className:"".concat(l.timeMessage)},f),p))})),Za=Object(L.a)((function(e){return{chatConversation:{position:"relative",flexGrow:1,display:"flex",flexDirection:"column",overflowY:"auto",height:"100%"},offset:e.mixins.toolbar,offsetDown:Object(B.a)(Object(B.a)({},e.mixins.toolbar),{},{bottom:0,position:"relative"})}})),Xa=function(e){var t=e.contact,a=e.avatarSrc,n=e.messages,o=e.idioma;r.a.useEffect((function(){var e=document.getElementById("chatConversation");e&&(e.scrollTop=e.scrollHeight)}));var c=Za();return r.a.createElement("div",{id:"chatConversation",className:c.chatConversation},r.a.createElement("div",{className:c.offset}),n.map((function(e,n,c){return r.a.createElement(Qa,Object.assign({},e,{key:n,contact:t,avatarSrc:a,idioma:o}))})),r.a.createElement("div",{className:c.offsetDown}))},en=a(190),tn=function(){var e=Object(i.useRecoilValue)(b),t=Object(i.useSetRecoilState)(pe),a=Object(i.useRecoilValue)(v(e)),o=Object(i.useRecoilValue)(u),c=Object(i.useRecoilValue)(s),d=Object(i.useRecoilValue)(l),m=Object(i.useRecoilValue)(fe),f=Ee().postRequest,p=m.find((function(t){return t.contactId===e}));return Object(n.useEffect)((function(){0===a.length&&f({url:"/messages/getMessagesByContact",messageOnError:en.errorLoadConversation[d],bodyParams:{contactId:p.contactId},doFnAfterSuccess:function(e,a){200===e.status&&(t({contactId:p.contactId,conversation:e.data.conversation}),Me.getSocket().emit("read messages",{readerId:c.userId,messengerId:p.contactId,messengerSocketId:p.socketId,token:a}))}})}),[]),a?r.a.createElement(Xa,{contact:p,avatarSrc:o,messages:a,idioma:d}):null},an=function(e){return r.a.createElement(tn,null)},nn=a(191),rn=a.n(nn),on=Object(L.a)((function(e){var t;return{appBar:(t={top:"auto",bottom:0,position:"fixed",width:"100%"},Object(Ta.a)(t,e.breakpoints.up("sm"),{width:e.breakpoints.values.sm}),Object(Ta.a)(t,"right","auto"),t),grow:{flexGrow:1},toolbar:{padding:0},icon:{fontSize:e.spacing(3.75)},textarea:{border:"1px solid gray",fontFamily:"inherit",fontSize:"large",padding:"1px 6px",backgroundColor:"white",color:"rgba(0,0,0,0.7)",width:"100%",marginTop:e.spacing(1),marginBottom:e.spacing(1),maxHeight:e.spacing(10),minHeight:e.spacing(4),overflowY:"auto",borderRadius:e.spacing(.5),marginLeft:e.spacing(2)}}})),cn=function(e){var t=e.sendMessage,a=e.refAreaTexto,n=e.keyPress,o=on();return r.a.createElement(na.a,{color:"primary",className:o.appBar},r.a.createElement(ra.a,{variant:"dense",className:o.toolbar},r.a.createElement("div",{className:o.textarea,role:"textbox",contentEditable:!0,ref:a,onKeyPress:n}),r.a.createElement("div",{className:o.grow}),r.a.createElement(S.a,{color:"inherit",onClick:t},r.a.createElement(rn.a,{className:o.icon}))))},ln=function(e){var t=Object(i.useRecoilValue)(s),a=Object(i.useSetRecoilState)(ge),o=Object(i.useRecoilValue)(b),c=Object(i.useRecoilValue)(fe).find((function(e){return e.contactId===o})),l=Object(n.useRef)(""),u=Object(n.useState)(0),d=Object(y.a)(u,2),m=d[0],f=d[1],p=function(){""!==l.current.innerText.replace(/^(\s*\r*)(.)(\s*\r*)$/,"$2")&&(a({contactId:c.contactId,messageId:m,content:l.current.innerText,datetime:new Date,state:1}),f((function(e){return e+1})),Me.getSocket().emit("send message",{content:l.current.innerText,userOriginId:t.userId,userDestinyId:o,toSocketId:c.socketId,token:localStorage.getItem("token"),consecutive:m}),l.current.innerText="",l.current.focus())};return Object(n.useEffect)((function(){l.current.focus()})),r.a.createElement(cn,{sendMessage:p,keyPress:function(e){13===e.charCode&&(e.preventDefault(),p())},refAreaTexto:l})},sn=function(e){return r.a.createElement(ln,null)},un=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Wa,null),r.a.createElement(an,null),r.a.createElement(sn,null))},dn=function(e){return r.a.createElement(un,null)},mn=a(32),fn=Object(L.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}}));function pn(e){var t=e.idioma,a=e.onSignUp,n=e.emailState,o=e.onEmailChange,c=e.passState,i=e.onPassChange,l=e.nameState,s=e.onNameChange,u=e.lastNameRef,d=fn();return r.a.createElement(P.a,{component:"main",maxWidth:"xs"},r.a.createElement(k.a,null),r.a.createElement("div",{className:d.paper},r.a.createElement(w.a,{className:d.avatar},r.a.createElement(q.a,null)),r.a.createElement(z.a,{component:"h1",variant:"h5"},mn.signup[t]),r.a.createElement("form",{className:d.form,noValidate:!0},r.a.createElement(T.a,{container:!0,spacing:2},r.a.createElement(T.a,{item:!0,xs:12,sm:6},r.a.createElement(R.a,{autoComplete:"fname",name:"firstName",variant:"outlined",required:!0,fullWidth:!0,id:"firstName",label:mn.firstName[t],autoFocus:!0,value:l.value,helperText:l.valid?"":mn[l.msg][t],error:!l.valid,onChange:s})),r.a.createElement(T.a,{item:!0,xs:12,sm:6},r.a.createElement(R.a,{variant:"outlined",fullWidth:!0,id:"lastName",label:mn.lastName[t],name:"lastName",autoComplete:"lname",inputRef:u})),r.a.createElement(T.a,{item:!0,xs:12},r.a.createElement(R.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:mn.email[t],name:"email",autoComplete:"email",value:n.value,helperText:n.valid?"":mn.invalidEmail[t],error:!n.valid,onChange:o})),r.a.createElement(T.a,{item:!0,xs:12},r.a.createElement(R.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password",label:mn.password[t],type:"password",id:"password",autoComplete:"current-password",value:c.value,helperText:c.valid?"":mn[c.msg][t],error:!c.valid,onChange:i}))),r.a.createElement(x.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:d.submit,onClick:a},mn.signup[t]),r.a.createElement(T.a,{container:!0,justify:"flex-end"},r.a.createElement(T.a,{item:!0},r.a.createElement(_.a,{to:"/"},mn.signin[t]))))))}var gn=function(e){var t=Object(i.useRecoilValue)(l),a=U(),o=a.openSuccessNotification,c=a.openErrorNotification,s=Object(n.useState)({value:"",valid:!0}),u=Object(y.a)(s,2),d=u[0],m=u[1],f=Object(n.useState)({value:"",valid:!0}),p=Object(y.a)(f,2),g=p[0],b=p[1],v=Object(n.useState)({value:"",valid:!0}),E=Object(y.a)(v,2),h=E[0],k=E[1],S=Object(n.useRef)();return r.a.createElement(pn,{idioma:t,lastNameRef:S,nameState:h,passState:g,emailState:d,onSignUp:function(e){e.preventDefault(),/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(d.value)?g.value.length<8?b(Object(B.a)(Object(B.a)({},g),{},{valid:!1,msg:"passShort"})):/^[a-zA-Z\']+$/.test(h.value)?h.value.length<2?k(Object(B.a)(Object(B.a)({},h),{},{valid:!1,msg:"nameShort"})):h.value.length>=20?k(Object(B.a)(Object(B.a)({},h),{},{valid:!1,msg:"nameLong"})):C.a.post("".concat(Q.server,"/users/signup"),{firstName:h.value,lastName:S.current.value,email:d.value,password:g.value,language:t,hostname:window.location.host}).then((function(e){201===e.status&&o(mn.userCreated[t])})).catch((function(e){409===e.response.status?c(mn.duplicated[t]):c(mn.error[t])})):k(Object(B.a)(Object(B.a)({},h),{},{valid:!1,msg:"nameInvalid"})):m(Object(B.a)(Object(B.a)({},d),{},{valid:!1}))},onNameChange:function(e){var t=e.target.value;k(Object(B.a)(Object(B.a)({},h),{},{value:t,valid:!0}))},onEmailChange:function(e){var t=e.target.value;m(Object(B.a)(Object(B.a)({},d),{},{value:t,valid:!0}))},onPassChange:function(e){var t=e.target.value;b(Object(B.a)(Object(B.a)({},g),{},{value:t,valid:!0}))}})},bn=function(e){return r.a.createElement(gn,null)},vn=a(407),En=a(400);function hn(e){return r.a.createElement(En.a,Object.assign({elevation:6,variant:"filled"},e))}var kn=function(){var e=Object(i.useRecoilState)(W),t=Object(y.a)(e,2),a=t[0],n=t[1],o=function(e,t){"clickaway"!==t&&n(Object(B.a)(Object(B.a)({},a),{},{open:!1}))};return r.a.createElement(vn.a,{open:a.open,autoHideDuration:a.autoHideDuration,onClose:o,anchorOrigin:{vertical:"top",horizontal:"center"}},r.a.createElement(hn,{onClose:o,severity:a.severity},a.msg))},Sn=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(kn,null))},On=a(47),jn=Object(L.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function yn(e){var t=e.idioma,a=e.passState,n=e.pass2State,o=e.onPassChange,c=e.onPass2Change,i=e.submitPass,l=jn();return r.a.createElement(P.a,{component:"main",maxWidth:"xs"},r.a.createElement("div",{className:l.paper},r.a.createElement(w.a,{className:l.avatar},r.a.createElement(q.a,null)),r.a.createElement(z.a,{component:"h1",variant:"h5"},On.title[t]),r.a.createElement("form",{className:l.form,noValidate:!0},r.a.createElement(R.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:On.password[t],type:"password",id:"password",autoComplete:"current-password",value:a.value,onChange:o,helperText:a.valid?"":On.invalidPass[t],error:!a.valid}),r.a.createElement(R.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:On.repeatPassword[t],type:"password",id:"password",autoComplete:"current-password",value:n.value,onChange:c,helperText:n.valid?"":On.passNotEqual[t],error:!n.valid}),r.a.createElement(x.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:l.submit,onClick:i},On.changePass[t]),r.a.createElement(T.a,{container:!0,justify:"flex-end"},r.a.createElement(T.a,{item:!0},r.a.createElement(_.a,{to:"/"},On.signin[t]))))))}var In=Object(h.withRouter)((function(e){var t=Object(i.useRecoilValue)(l),a=U(),o=a.openErrorNotification,c=a.openSuccessNotification,s=Object(n.useState)({value:"",valid:!0}),u=Object(y.a)(s,2),d=u[0],m=u[1],f=Object(n.useState)({value:"",valid:!0}),p=Object(y.a)(f,2),g=p[0],b=p[1];return r.a.createElement(yn,{idioma:t,passState:d,pass2State:g,onPassChange:function(e){var t=e.target.value;m(Object(B.a)(Object(B.a)({},d),{},{value:t,valid:!0})),b(Object(B.a)(Object(B.a)({},g),{},{valid:!0}))},onPass2Change:function(e){var t=e.target.value;b(Object(B.a)(Object(B.a)({},g),{},{value:t,valid:!0}))},submitPass:function(a){if(a.preventDefault(),d.value.length<8)m(Object(B.a)(Object(B.a)({},d),{},{valid:!1}));else if(g.value!==d.value)b(Object(B.a)(Object(B.a)({},g),{},{valid:!1}));else{var n=e.match.params.token;C.a.post("".concat(Q.server,"/users/resetpassword"),{token:n,password:d.value}).then((function(e){200===e.status&&c(On.passChangeOk[t])})).catch((function(e){o(On.passChangeError[t])}))}}})})),Cn=function(e){return r.a.createElement(In,null)},wn=a(412),xn=a(397),Rn=a(405),Nn=a(398),An=a(369),Dn=a(402),Tn=a(104),Fn=a(396),qn=a(19),zn=a(192),Ln=a.n(zn),Pn=Object(L.a)((function(e){return{root:{width:"100%",height:"100%",paddingTop:e.spacing(2),overflowY:"auto"},button:{marginTop:e.spacing(1),marginRight:e.spacing(1)},actionsContainer:{marginBottom:e.spacing(2)},Stepper:{backgroundColor:"transparent"},combo:{minWidth:120},avatarPink:{color:e.palette.getContrastText(Tn.a[300]),backgroundColor:Tn.a[300],marginLeft:e.spacing(7),width:e.spacing(10),height:e.spacing(10)},avatarBlue:{color:e.palette.getContrastText(Fn.a[500]),backgroundColor:Fn.a[500],marginLeft:e.spacing(7),width:e.spacing(10),height:e.spacing(10)},avatarButton:{padding:0,borderRadius:"50%",minWidth:0},avatarEdit:{margin:e.spacing(2),marginLeft:e.spacing(3),display:"flex",flexDirection:"row",alignItems:"center",justifyContent:""}}})),Vn=function(e){var t=e.idioma,a=e.activeStep,n=e.handleFinish,o=e.handleLanguageChange,c=e.sexSelectHandler,i=e.sexState,l=e.nicknameState,s=e.setNicknameHandler,u=e.preview,d=e.setPreview,m=e.goNextConf,f=e.goBackConf,p=e.sendActivation,g=e.activationError,b=e.avatarRef,v=Pn();return r.a.createElement("div",{className:v.root},r.a.createElement(P.a,null,r.a.createElement(z.a,{variant:"h6"},"".concat(qn.hello[t]).concat(l).concat(qn.hello1[t])),r.a.createElement(z.a,{variant:"body1"},qn.descriptionText[t])),r.a.createElement(ke.a,null),r.a.createElement(wn.a,{activeStep:a,orientation:"vertical",className:v.Stepper},r.a.createElement(xn.a,null,r.a.createElement(Rn.a,null,qn.labelIdioma[t]),r.a.createElement(Nn.a,null,r.a.createElement(An.a,{variant:"standard",className:v.combo},r.a.createElement(Dn.a,{id:"input-language",value:t,onChange:o},r.a.createElement(ze.a,{value:"en"},"English"),r.a.createElement(ze.a,{value:"es"},"Espa\xf1ol")),r.a.createElement(x.a,{variant:"contained",color:"primary",onClick:m,className:v.button},qn.next[t])))),r.a.createElement(xn.a,null,r.a.createElement(Rn.a,null,qn.labelSexo[t]),r.a.createElement(Nn.a,null,r.a.createElement(An.a,{variant:"standard",className:v.combo},r.a.createElement(Dn.a,{id:"input-language",value:i,onChange:c},r.a.createElement(ze.a,{value:"M"},"Masculino"),r.a.createElement(ze.a,{value:"F"},"Femenino"))),r.a.createElement("div",{className:v.actionsContainer},r.a.createElement("div",null,r.a.createElement(x.a,{variant:"contained",color:"secondary",onClick:f,className:v.button},qn.back[t]),r.a.createElement(x.a,{disabled:null==i,variant:"contained",color:"primary",onClick:m,className:v.button},qn.next[t]))))),r.a.createElement(xn.a,null,r.a.createElement(Rn.a,null,qn.labelNickname[t]),r.a.createElement(Nn.a,null,r.a.createElement(An.a,{variant:"standard",className:v.combo},r.a.createElement(R.a,{id:"standard-basic",placeholder:qn.labelNickname[t],value:l,onChange:s})),r.a.createElement("div",{className:v.actionsContainer},r.a.createElement("div",null,r.a.createElement(x.a,{variant:"contained",color:"secondary",onClick:f,className:v.button},qn.back[t]),r.a.createElement(x.a,{disabled:""===l,variant:"contained",color:"primary",onClick:m,className:v.button},qn.next[t]))))),r.a.createElement(xn.a,null,r.a.createElement(Rn.a,null,qn.labelAvatar[t]),r.a.createElement(Nn.a,null,r.a.createElement("div",{className:v.avatarEdit},r.a.createElement(Ln.a,{width:120,height:100,onCrop:function(e){d(e)},onClose:function(){d(null)},closeIconColor:Tn.a[500],label:qn.choosefile[t],ref:b}),r.a.createElement(w.a,{alt:"".concat(l),src:u,variant:"circle",className:"F"===i?v.avatarPink:v.avatarBlue})),r.a.createElement("div",{className:v.actionsContainer},r.a.createElement("div",null,r.a.createElement(x.a,{variant:"contained",color:"secondary",onClick:f,className:v.button},qn.back[t]),r.a.createElement(x.a,{disabled:""===l,variant:"contained",color:"primary",onClick:p,className:v.button},qn.next[t]))))),r.a.createElement(xn.a,null,r.a.createElement(Rn.a,{error:g},qn.label1[t])),r.a.createElement(xn.a,null,r.a.createElement(Rn.a,null,qn.label3[t]),r.a.createElement(Nn.a,null,r.a.createElement(z.a,null,qn.content3[t]),r.a.createElement("div",{className:v.actionsContainer},r.a.createElement("div",null,r.a.createElement(x.a,{variant:"contained",color:"primary",onClick:n,className:v.button},qn.goLogin[t])))))),r.a.createElement(ke.a,null))},_n=Object(h.withRouter)((function(e){var t=Object(i.useRecoilState)(l),a=Object(y.a)(t,2),o=a[0],c=a[1],s=Object(n.useState)(0),u=Object(y.a)(s,2),d=u[0],m=u[1],f=Object(n.useState)(!1),p=Object(y.a)(f,2),g=p[0],b=p[1],v=Object(n.useState)(null),E=Object(y.a)(v,2),k=E[0],S=E[1],O=Object(n.useState)(null),j=Object(y.a)(O,2),I=j[0],w=j[1],x=Object(n.useState)(e.match.params.nickname),R=Object(y.a)(x,2),N=R[0],A=R[1],D=Object(n.useState)(null),T=Object(y.a)(D,2),F=T[0],q=T[1],z=Object(n.useRef)(null),L=function(){m((function(e){return e+1}))};return k?r.a.createElement(h.Redirect,{to:"/"}):r.a.createElement(Vn,{idioma:o,activeStep:d,handleFinish:function(){S(!0)},handleLanguageChange:function(e){var t=e.target.value;c(t)},sexSelectHandler:function(e){var t=e.target.value;w(t)},sexState:I,nicknameState:N,setNicknameHandler:function(e){var t=e.target.value;A(t)},preview:F,setPreview:q,goNextConf:L,goBackConf:function(){m((function(e){return e-1}))},sendActivation:function(){L(),C.a.post("".concat(Q.server,"/users/activate"),{token:e.match.params.token,language:o,gender:I,nickname:N,avatar:F}).then((function(e){200===e.status&&L()})).catch((function(e){b(!0)}))},activationError:g,avatarRef:z})})),Bn=function(e){return r.a.createElement(_n,null)},Wn=a(25),Un=a(21),Mn=function(e){var t=Me.getSocket(),a=Object(i.useSetRecoilState)(fe),o=Object(i.useRecoilValue)(s),c=Object(Wn.b)().enqueueSnackbar;return Object(n.useEffect)((function(){return t.on("new user",(function(e){console.log("new user"),a({action:"connect",payload:{data:e,notification:c,msg:Un.connected}})})),o&&t.emit("new user",{userId:o.userId}),function(){return t.off("new user")}}),[a,t,o]),r.a.createElement(r.a.Fragment,null)},Hn=function(e){var t=Object(i.useSetRecoilState)(fe),a=Me.getSocket(),o=Object(Wn.b)().enqueueSnackbar;return Object(n.useEffect)((function(){return a.on("user disconnect",(function(e){t({action:"disconnect",payload:{socketId:e.socketId,notification:o,msg:Un.disconnected}})})),function(){return a.off("user disconnect")}}),[]),r.a.createElement(r.a.Fragment,null)},Jn=function(e){var t=Object(i.useRecoilState)(d),a=Object(y.a)(t,2),o=a[0],c=a[1],l=Me.getSocket();return Object(n.useEffect)((function(){return l.on("message",(function(e){var t=Object(B.a)({},o);o[e.socketId]?(t[e.socketId]=Object(B.a)({},o[e.socketId]),o[e.socketId].text?(t[e.socketId].text=[].concat(Object(me.a)(o[e.socketId].text),[{myMsg:!1,msg:e.msg}]),e.socketId!==t.active&&(t[e.socketId].novistos=t[e.socketId].novistos+1)):t[e.socketId].text=[]):t[e.socketId]={text:[{myMsg:!1,msg:e.msg}],nickname:null,socketId:null,novistos:1},c(t)})),function(){return l.off("message")}}),[o]),r.a.createElement(r.a.Fragment,null)},Gn=function(e){var t=Me.getSocket(),a=Object(i.useSetRecoilState)(fe),o=Object(Wn.b)().enqueueSnackbar,c=(Object(i.useRecoilValue)(s),Object(i.useRecoilValue)(l));U().openErrorNotification;return Object(n.useEffect)((function(){return t.on("declined friendship",(function(e){var t=e.declinerId,n=(e.declinedId,e.socketIdDecliner);e.socketIdDeclined;le((function(e){C.a.post("".concat(Q.server,"/users/getFriendById"),{friendId:t},{headers:{Authorization:e}}).then((function(e){if(200===e.status)return a({action:"update",payload:{friend:Object(B.a)(Object(B.a)({},e.data.friend),{},{socketId:n})}}),e.data.friend})).then((function(e){o("".concat(e.nickname," ").concat(Un.declinedInv[c]),{variant:"warning"})})).catch((function(e){404===e.response.status&&a({action:"delete",payload:{friendId:t}})}))}))})),function(){return t.off("declined friendship")}}),[]),r.a.createElement(r.a.Fragment,null)},Yn=function(e){var t=Me.getSocket(),a=Object(i.useSetRecoilState)(fe),o=Object(Wn.b)().enqueueSnackbar,c=Object(i.useRecoilValue)(s),u=Object(i.useRecoilValue)(l),d=U().openErrorNotification;return Object(n.useEffect)((function(){return t.on("requested friendship",(function(e){var t=e.userIdRequester,n=e.userIdRequested,r=e.socketIdRequester;if(n===c.userId){le((function(e){C.a.post("".concat(Q.server,"/users/getFriendById"),{friendId:t},{headers:{Authorization:e}}).then((function(e){if(200===e.status)return a({action:"add",payload:{friend:Object(B.a)(Object(B.a)({},e.data.friend),{},{socketId:r})}}),e.data.friend})).then((function(e){o("".concat(e.nickname," ").concat(Un.requestedInv[u]),{variant:"success"})})).catch((function(e){d(Un.errorLoadingFriends[u])}))}))}})),function(){return t.off("requested friendship")}}),[]),r.a.createElement(r.a.Fragment,null)},Kn=function(e){var t=Me.getSocket(),a=Object(i.useSetRecoilState)(fe),o=Object(Wn.b)().enqueueSnackbar,c=(Object(i.useRecoilValue)(s),Object(i.useRecoilValue)(l)),u=U().openErrorNotification;return Object(n.useEffect)((function(){return t.on("accepted friendship",(function(e){var t=e.accepterId,n=e.socketIdAccepter;le((function(e){C.a.post("".concat(Q.server,"/users/getFriendById"),{friendId:t},{headers:{Authorization:e}}).then((function(e){if(200===e.status)return a({action:"update",payload:{friend:Object(B.a)(Object(B.a)({},e.data.friend),{},{socketId:n})}}),e.data.friend})).then((function(e){o("".concat(e.nickname," ").concat(Un.accept[c]),{variant:"success"})})).catch((function(e){u(Un.errorLoadingFriends[c])}))}))})),function(){return t.off("accepted friendship")}}),[]),r.a.createElement(r.a.Fragment,null)},$n=function(e){var t=Me.getSocket(),a=Object(i.useSetRecoilState)(fe),o=Object(Wn.b)().enqueueSnackbar,c=Object(i.useRecoilValue)(l),s=U().openErrorNotification;return Object(n.useEffect)((function(){return t.on("deleted contact",(function(e){var t=e.deleterId,n=e.socketIdDeleter;le((function(e){C.a.post("".concat(Q.server,"/users/getFriendById"),{friendId:t},{headers:{Authorization:e}}).then((function(e){if(200===e.status)return a({action:"update",payload:{friend:Object(B.a)(Object(B.a)({},e.data.friend),{},{socketId:n})}}),e.data.friend})).then((function(e){o("".concat(e.nickname," ").concat(Un.delete[c]),{variant:"error"})})).catch((function(e){s(Un.errorLoadingFriends[c])}))}))})),function(){return t.off("deleted contact")}}),[]),r.a.createElement(r.a.Fragment,null)},Qn=function(e){var t=Me.getSocket(),a=Object(i.useSetRecoilState)(fe),o=Object(Wn.b)().enqueueSnackbar,c=Object(i.useRecoilValue)(l),s=U().openErrorNotification;return Object(n.useEffect)((function(){return t.on("blocked contact",(function(e){var t=e.blokerId,n=e.socketIdBloked;le((function(e){C.a.post("".concat(Q.server,"/users/getFriendById"),{friendId:t},{headers:{Authorization:e}}).then((function(e){if(200===e.status)return a({action:"update",payload:{friend:Object(B.a)(Object(B.a)({},e.data.friend),{},{socketId:n})}}),e.data.friend})).then((function(e){o("".concat(e.nickname," ").concat(Un.block[c]),{variant:"error"})})).catch((function(e){s(Un.errorLoadingFriends[c])}))}))})),function(){return t.off("bloked contact")}}),[]),r.a.createElement(r.a.Fragment,null)},Zn=function(e){var t=Me.getSocket(),a=Object(i.useSetRecoilState)(ge),o=Object(i.useSetRecoilState)(be),c=Object(i.useSetRecoilState)(ve),u=Object(i.useRecoilValue)(s),d=Object(i.useRecoilValue)(b),m=Object(Wn.b)().enqueueSnackbar,f=Object(i.useRecoilState)(fe),p=Object(y.a)(f,2),g=p[0],v=p[1],E=Object(i.useRecoilValue)(l);return Object(n.useEffect)((function(){return t.on("recived message",(function(e){var t=e.content,n=e.userOriginId,r=(e.socketIdSender,e.messageId),o=e.datetime,c=(e.consecutive,g.find((function(e){return e.contactId===n})));if(d!==n){m("".concat(c.nickname," ").concat(Un.writingYou[E]),{variant:"info"});var i={};i[n]={cantidad:1,lastMessage:t,datetime:o},v({action:"set_message_info",payload:{dataObj:i}})}else{Me.getSocket().emit("read messages",{userId:u.userId,contactId:c.contactId,notifyTo:c.socketId,token:localStorage.getItem("token")})}a({contactId:n,messageId:r,content:t,datetime:o,state:0})})),t.on("saved message",(function(e){var t=e.contactId,a=e.messageId,n=e.datetime,r=e.consecutive;e.soketIdContact;o({contactId:t,messageId:a,datetime:n,consecutive:r})})),t.on("readed messages",(function(e){var t=e.contactId;c({contactId:t})})),function(){t.off("recived message"),t.off("saved message"),t.off("readed messages")}})),r.a.createElement(r.a.Fragment,null)},Xn=function(){var e=Object(i.useSetRecoilState)(E),t=Ia();return Object(n.useCallback)((function(){var a=localStorage.getItem("token"),n=localStorage.getItem("refresh_token"),r=localStorage.getItem("refresh_token_expires");if(n&&r&&new Date(r).getTime()>(new Date).getTime())return console.log("Antes de llamar al endpoint refreshtoken"),C.a.post("".concat(Q.server,"/users/refreshtoken"),{token:a,refresh_token:n}).then((function(t){if(200===t.status){var a=t.data,n=a.new_token,r=a.new_refresh_token,o=a.new_token_expires,c=a.new_refresh_token_expires;localStorage.setItem("token",n),localStorage.setItem("refresh_token",r),localStorage.setItem("token_expires",o),localStorage.setItem("refresh_token_expires",c),e({timeleft:o})}})).catch((function(e){t()}));t()}),[t,e])},er=function(){var e=Xn(),t=Object(i.useRecoilValue)(E);return r.a.useEffect((function(){var a=new Date(t.timeleft).getTime()-(new Date).getTime();a>=1e4&&setTimeout((function(){e()}),a-1e4)}),[t]),r.a.createElement(r.a.Fragment,null)},tr=function(){var e=Object(i.useRecoilValue)(f),t=Object(i.useRecoilValue)(s),a=Object(i.useRecoilValue)(b),n=r.a.createRef(),o=function(e){return function(){n.current.closeSnackbar(e)}},c=null!==t?r.a.createElement(r.a.Fragment,null,a?r.a.createElement(dn,null):r.a.createElement(h.Route,{path:"/contacts",exact:!0,render:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Da,null),r.a.createElement(Xt,null),r.a.createElement(It,null))}})):null;return r.a.createElement(aa,null,r.a.createElement(k.a,null),r.a.createElement(Sn,null),r.a.createElement(Wn.a,{maxSnack:3,autoHideDuration:3e3,preventDuplicate:!0,anchorOrigin:{vertical:"top",horizontal:"left"},ref:n,action:function(e){return r.a.createElement(S.a,{onClick:o(e)},r.a.createElement(j.a,{fontSize:"small",style:{color:"white"}}))}},r.a.createElement(h.Switch,null,r.a.createElement(h.Route,{path:"/",exact:!0,component:ue}),r.a.createElement(h.Route,{path:"/signup",exact:!0,component:bn}),c,r.a.createElement(h.Route,{path:"/changepass/:token",exact:!0,component:Cn}),r.a.createElement(h.Route,{path:"/activateuser/:token/:nickname",exact:!0,component:Bn}),r.a.createElement(h.Redirect,{from:"/",to:"/"})),e?r.a.createElement(r.a.Fragment,null,r.a.createElement(Mn,null),r.a.createElement(Hn,null),r.a.createElement(Jn,null),r.a.createElement(Yn,null),r.a.createElement(Gn,null),r.a.createElement(Kn,null),r.a.createElement($n,null),r.a.createElement(Qn,null),r.a.createElement(Zn,null)):null,r.a.createElement(er,null)))},ar=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function nr(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var rr=a(56);a(294),a(295),a(296),a(297);c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(i.RecoilRoot,null,r.a.createElement(rr.a,null,r.a.createElement(tr,null)))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");ar?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):nr(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):nr(t,e)}))}}()},32:function(e){e.exports=JSON.parse('{"signup":{"es":"Crear cuenta","en":"Sign up"},"firstName":{"es":"Nombre","en":"First Name"},"lastName":{"es":"Apellidos","en":"Last Name"},"email":{"es":"Correo Electr\xf3nico","en":"Email Address"},"password":{"es":"Contrase\xf1a","en":"Password"},"signin":{"es":"Ya tienes una cuenta? Reg\xedstrate!","en":"Already have an account? Sign in!"},"invalidEmail":{"es":"Correo inv\xe1lido","en":"Invalid email"},"passShort":{"es":"Debe tener al menos 8 caracteres","en":"Must have at least 8 characters"},"nameInvalid":{"es":"Sin espacios. Sin n\xfameros.","en":"No spaces. No numbers."},"nameShort":{"es":"Muy corto (min 2)","en":"Too Short (2 min)"},"nameLong":{"es":"Muy largo (max 20)","en":"Too long (max 20)"},"duplicated":{"es":"El correo ya se encuentra registrado.","en":"The email is already registered."},"error":{"es":"Error interno","en":"Internal error"},"userCreated":{"es":"Usuario creado. Revise su correo para activarlo.","en":"User created. Check your email to activate it."}}')},45:function(e){e.exports=JSON.parse('{"title":{"en":"Reset password","es":"Cambiar contrase\xf1a"},"email":{"en":"Email Address","es":"Correo Electr\xf3nico"},"forgotText":{"es":"Escriba su correo electr\xf3nico y le enviaremos un enlace para que pueda cambiar su contrase\xf1a.","en":"Write your email, and we send you a link in wish you can change your password."},"forgotBtnOk":{"es":"Continuar","en":"Continue"},"forgotBtnCancel":{"es":"Cancelar","en":"Cancel"},"invalidEmail":{"es":"Correo inv\xe1lido","en":"Invalid email"},"emailSended":{"es":"Revise su bandeja de entrada de correos","en":"Check your email inbox"},"emailNotFound":{"es":"Correo no encontrado","en":"Email not found"},"error":{"es":"Error interno","en":"Internal error"}}')},46:function(e){e.exports=JSON.parse('{"signin":{"es":"Entrar","en":"Sign in"},"email":{"en":"Email Address","es":"Correo Electr\xf3nico"},"password":{"en":"Password","es":"Contrase\xf1a"},"rememberme":{"en":"Remember me","es":"Recu\xe9rdame"},"forgotpassword":{"en":"Forgot password?","es":"Olvid\xf3 su contrase\xf1a?"},"gosignup":{"en":"Dont have an account? Sign Up!","es":"No tienes una cuanta? Cre\xe1tela!"},"notAuthorized":{"en":"Not authorized","es":"No autorizado"},"internalError":{"en":"Internal error","es":"Error interno"}}')},47:function(e){e.exports=JSON.parse('{"title":{"es":"Cambiar contrase\xf1a","en":"Change password"},"password":{"es":"Contrase\xf1a","en":"Password"},"invalidPass":{"es":"Debe tener al menos 8 caracteres","en":"Must have at least 8 characters"},"repeatPassword":{"es":"Repita la contrase\xf1a","en":"Repeat password"},"passNotEqual":{"es":"Las contrase\xf1as no son iguales","en":"The passwords are not equal"},"changePass":{"es":"Cambiar contrase\xf1a","en":"Change password"},"passChangeOk":{"es":"La contrase\xf1a ha sido cambiada","en":"Your password has been changed"},"passChangeError":{"es":"La contrase\xf1a no se pudo cambiar","en":"The password can\'t be changed"},"signin":{"es":"Ir a la p\xe1gina de registro","en":"Go to login page"}}')},60:function(e){e.exports=JSON.parse('{"title":{"es":"Adicionar contacto","en":"Add contact"},"search":{"es":"Buscar...","en":"Search..."},"close":{"es":"Cerrar","en":"Close"},"lbErrorLoadingUsers":{"es":"Error al cargar los usuarios","en":"Error loading users"},"lbErrorSendigFriendRequest":{"es":"Error al enviar solicitud de amistad","en":"Error sending friend request"}}')},98:function(e){e.exports=JSON.parse('{"acceptInv":{"es":"Aceptar amigo","en":"Accept friend"},"errorAccepting":{"es":"Error al aceptar la solicitud","en":"Error accepting the friend request"}}')},99:function(e){e.exports=JSON.parse('{"block":{"es":"Bloquear contacto","en":"Block contact"},"onBlockError":{"es":"El contacto no se pudo bloquear","en":"Contact could not be block"}}')}},[[212,1,2]]]);
//# sourceMappingURL=main.21c85ae5.chunk.js.map